import{S as Z,t as j,n as $,o as ee,c as k,u as q,Q as te,O as se,W as ne,s as ie,V as oe,R as re,T as ae,G as le,e as ce,a as de,f as ue,A as he,P as pe,l as me}from"./three.module-DxqIPYNp.js";import{R as fe}from"./RGBELoader-D3K8c0oI.js";import{e as u,a as ve}from"./eventHub-C6b7Eskn.js";import{O as ge}from"./OrbitControls-UtDBv3EV.js";import"./init-BnaqhK5o.js";import{G as ye}from"./GLTFLoader-CeTFqpKO.js";import{D as _e}from"./DRACOLoader-BFhmOIHI.js";import{g as E}from"./index-DjKJqAo0.js";import{r as O,o as we,a as R,c as W,b as o,F as Ce,_ as xe,u as A,p as Se,e as Ae,g as U}from"./index-14mOdFxx.js";let C=new Z,Me=new fe,Ge=new URL("/assets/2k-CzDr2HGN.hdr",import.meta.url).href;Me.loadAsync(Ge).then(l=>{l.mapping=j,C.background=l,C.environment=l});const I=new $(16777215,1);I.position.set(10,100,10);C.add(I);let Be=document.querySelector(".left-menu").offsetWidth||180,Ee=window.innerWidth-Be,Pe=window.innerHeight,D=new ee(75,Ee/Pe,.1,1e5);D.position.set(100,100,300);class be{constructor(){this.activeCamera=D,this.cameraCollect={default:D},u.on("toggleCamera",t=>{this.setActiveCamera(t)})}addCamera(t,n){this.cameraCollect[t]=n}setActiveCamera(t){this.activeCamera=this.cameraCollect[t]}}const M=new be,V=new k,Oe=new te,N=new k;class De extends se{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof Element&&n.element.parentNode!==null&&n.element.parentNode.removeChild(n.element)})})}copy(t,n){return super.copy(t,n),this.element=t.element.cloneNode(!0),this}}const y=new q,Le=new q;class ke{constructor(t={}){const n=this;let r,c,m,v;const h={camera:{style:""},objects:new WeakMap},a=t.element!==void 0?t.element:document.createElement("div");a.style.overflow="hidden",this.domElement=a;const d=document.createElement("div");d.style.transformOrigin="0 0",d.style.pointerEvents="none",a.appendChild(d);const g=document.createElement("div");g.style.transformStyle="preserve-3d",d.appendChild(g),this.getSize=function(){return{width:r,height:c}},this.render=function(i,e){const f=e.projectionMatrix.elements[5]*v;e.view&&e.view.enabled?(d.style.transform=`translate( ${-e.view.offsetX*(r/e.view.width)}px, ${-e.view.offsetY*(c/e.view.height)}px )`,d.style.transform+=`scale( ${e.view.fullWidth/e.view.width}, ${e.view.fullHeight/e.view.height} )`):d.style.transform="",i.matrixWorldAutoUpdate===!0&&i.updateMatrixWorld(),e.parent===null&&e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld();let P,_;e.isOrthographicCamera&&(P=-(e.right+e.left)/2,_=(e.top+e.bottom)/2);const w=e.view&&e.view.enabled?e.view.height/e.view.fullHeight:1,x=e.isOrthographicCamera?`scale( ${w} )scale(`+f+")translate("+s(P)+"px,"+s(_)+"px)"+F(e.matrixWorldInverse):`scale( ${w} )translateZ(`+f+"px)"+F(e.matrixWorldInverse),G=(e.isPerspectiveCamera?"perspective("+f+"px) ":"")+x+"translate("+m+"px,"+v+"px)";h.camera.style!==G&&(g.style.transform=G,h.camera.style=G),z(i,i,e)},this.setSize=function(i,e){r=i,c=e,m=r/2,v=c/2,a.style.width=i+"px",a.style.height=e+"px",d.style.width=i+"px",d.style.height=e+"px",g.style.width=i+"px",g.style.height=e+"px"};function s(i){return Math.abs(i)<1e-10?0:i}function F(i){const e=i.elements;return"matrix3d("+s(e[0])+","+s(-e[1])+","+s(e[2])+","+s(e[3])+","+s(e[4])+","+s(-e[5])+","+s(e[6])+","+s(e[7])+","+s(e[8])+","+s(-e[9])+","+s(e[10])+","+s(e[11])+","+s(e[12])+","+s(-e[13])+","+s(e[14])+","+s(e[15])+")"}function T(i){const e=i.elements;return"translate(-50%,-50%)"+("matrix3d("+s(e[0])+","+s(e[1])+","+s(e[2])+","+s(e[3])+","+s(-e[4])+","+s(-e[5])+","+s(-e[6])+","+s(-e[7])+","+s(e[8])+","+s(e[9])+","+s(e[10])+","+s(e[11])+","+s(e[12])+","+s(e[13])+","+s(e[14])+","+s(e[15])+")")}function H(i){i.isCSS3DObject&&(i.element.style.display="none");for(let e=0,f=i.children.length;e<f;e++)H(i.children[e])}function z(i,e,f,P){if(i.visible===!1){H(i);return}if(i.isCSS3DObject){const _=i.layers.test(f.layers)===!0,w=i.element;if(w.style.display=_===!0?"":"none",_===!0){i.onBeforeRender(n,e,f);let x;i.isCSS3DSprite?(y.copy(f.matrixWorldInverse),y.transpose(),i.rotation2D!==0&&y.multiply(Le.makeRotationZ(i.rotation2D)),i.matrixWorld.decompose(V,Oe,N),y.setPosition(V),y.scale(N),y.elements[3]=0,y.elements[7]=0,y.elements[11]=0,y.elements[15]=1,x=T(y)):x=T(i.matrixWorld);const b=h.objects.get(i);if(b===void 0||b.style!==x){w.style.transform=x;const G={style:x};h.objects.set(i,G)}w.parentNode!==g&&g.appendChild(w),i.onAfterRender(n,e,f)}}for(let _=0,w=i.children.length;_<w;_++)z(i.children[_],e,f)}}}let Re=document.querySelector(".left-menu").offsetWidth||180,X=window.innerWidth-Re,J=window.innerHeight,B=new ne({antialias:!0,physicallyCorrectLights:!0,logarithmicDepthBuffer:!0});B.setSize(X,J);B.shadowMap.enabled=!0;B.toneMapping=ie;B.toneMappingExposure=.8;const K=new ke;K.setSize(X,J);const S={renderer:B,css3drender:K},Q=new ge(M.activeCamera,S.renderer.domElement);Q.enableDamping=!0;class We{constructor(){this.controls=Q}}const Fe=new We;var Te=`uniform sampler2D uTexture;
uniform vec3 uColor;
void main(){
    vec4 uTextureColor = texture2D(uTexture, gl_PointCoord);
    gl_FragColor = vec4(uColor, uTextureColor.x);
}`,He=`attribute vec3 aPosition; 
uniform float uTime;
void main(){
    vec4 currentPosition = modelMatrix * vec4(position, 1.0);
    vec3 direction = aPosition - currentPosition.xyz;
    

    vec3 targetPosition = currentPosition.xyz + direction * 0.1 * uTime;
    vec4 vPosition = viewMatrix * vec4(targetPosition, 1.0);
    gl_Position = projectionMatrix*vPosition;
    
    gl_PointSize = -100.0/vPosition.z;
}`;class ze{constructor(t){let n=new ye,r=new _e;r.setDecoderPath("/draco/"),r.setDecoderConfig({type:"js"}),r.preload(),n.setDRACOLoader(r),this.scene=t,this.floor1Group,this.floor2Group,this.wallGroup,this.floor2Tags=[];let c=["小型会议室","核心科技室","科技展台","设计总监办公室"],m=new URL("/assets/floor2-qUgHYOA0.glb",import.meta.url).href;n.load(m,h=>{this.floor2Group=h.scene,h.scene.traverse(a=>{if(a.isMesh&&(a.material.emissiveIntensity=15),c.indexOf(a.name)!=-1){let d=this.createTag(a);this.floor2Tags.push(d),this.floor2Group.add(d)}}),t.add(this.floor2Group)});let v=new URL("/assets/Fighter1-CSGuFXbK.glb",import.meta.url).href;n.load(v,h=>{this.fighterGroup=h.scene,t.add(this.fighterGroup),this.fighterGroup.position.set(3,42,68),this.fighterGroup.traverse(a=>{a.isMesh&&(a.material.emissiveIntensity=15,a.position2=a.position.clone())}),this.mouse=new oe,this.raycaster=new re,window.addEventListener("click",a=>{a.mesh=this,this.mouse.x=a.clientX/window.innerWidth*2-1,this.mouse.y=-(a.clientY/window.innerHeight*2-1),this.raycaster.setFromCamera(this.mouse,M.activeCamera),this.raycaster.intersectObject(this.fighterGroup).length>0&&console.log("点击了飞机")})}),this.initEvent()}update(t){this.mixer&&this.mixer.update(t)}createTag(t){const n=document.createElement("div");n.className="elementTag",n.innerHTML=`
        <div class="elementContent">
            <h3>${t.name}</h3>
            <p>温度：30℃</p>
            <p>湿度：40%</p>
        </div>
        `;const r=new De(n);return t.position,r.position.copy(t.position),r.scale.set(.2,.2,.2),r}initEvent(){u.on("flatFighter",()=>{let t=[];for(var n=0;n<5;n++)for(var r=0;r<5;r++)t.push(new k(n*2-2,r*2-2,0));let c=0;this.fighterGroup.traverse(m=>{m.isMesh&&(t[c].multiplyScalar(10),E.to(m.position,{x:"+="+t[c].x,y:"+="+t[c].y,z:"+="+t[c].z,duration:1}),c++)})}),u.on("recoverFighter",()=>{this.fighterGroup.traverse(t=>{t.isMesh&&E.to(t.position,{x:t.position2.x,y:t.position2.y,z:t.position2.z,duration:1})})}),u.on("pointsFighter",()=>{this.createPoints(this.fighterGroup),this.fighterPointsGroup&&(this.fighterPointsGroup.visible=!0),this.floor2Group.visible=!1,this.fighterGroup.visible=!1}),u.on("pointsBlast",()=>{this.pointsBlast()}),u.on("pointsBack",()=>{this.pointsBack()}),u.on("pointsRemove",()=>{this.fighterPointsGroup.visible=!1,this.floor2Group.visible=!0,this.fighterGroup.visible=!0})}createPoints(t){this.fighterPointsGroup||(this.fighterPointsGroup=this.transformPoints(t),this.scene.add(this.fighterPointsGroup))}transformPoints(t){let n=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAq1BMVEUAAAAGBgYLCwsQEBAYGBggICAcHBwUFBQnJyckJCQxMTHh4eHa2to+Pj7q6urKysqqqqouLi7n5+fk5ORiYmLt7e3X19fR0dG9vb25ubmenp6MjIx/f39HR0c6OjpdXV3v7+97e3tPT08rKys2NjbOzs7Dw8O0tLSWlpaSkpJ3d3d1dXVvb29sbGxbW1tXV1dUVFRMTExERERBQUGgoKA1NTXx8fHc3NyhoaGopjlnAAAB/ElEQVRIx+3WyZKbMBAG4CQTh1UGgcy+BIz3fZuZ93+ytBuqL4JiHF3nP/nyVbeMpNaP77yen5T/UJRX2C/KVympNwzZLzBCmkZ4jLYMjfYbAz+IjrgnA/GnyxMjlaTkNFSTLmi1To44VIahQwwDrSRlB+WAAeLchHAOGCgUHZTkgM3NpmC36/XGioc5B0pywL21jjcsr0/Hsjye6pw1vJVtt30Q1ofOLPKzOOyqLKt2B3HOCxOlBhKhXLBz7FLus3Sd3O/JOs325YV1EktKEBudTMDVYpsm7iqOonjlJulW1CixWYD9BXVeXES1ceOlswjDhbOM3U0lLgXXqaRcEJwxb/Jyu3EjJwxsSBA6kbvZlnkzh2axpAyxoMnO+xRcYFsYOwCZ7s+sLSlB6vSRiyyJneDD8n3P833rI3DiJBP5g3rtWSJ0WtSH1F2GtuV7U4jnW3a4dNNDXUCvtEh5iZydduuVEzzdDPKUgbNa706M0yJ7oG7ejlUSL6DgdPYXMptCyUWcVMebqQ9ADeG1zO4RdOoBfH8H6EGv0T0rrwg1ZTjeqie1qvDnKHyOsQ3g9WwAhS2nssnVjxUdZGPwIFPB8avj87Pv6lC4rEavRyGGr0f1C1keASZGGgEKQ0dpzKkPVnmUA8BIo1zh8aD0XFF/IKk/yciS+s7L+QfFrE8fdgvs9QAAAABJRU5ErkJggg==",import.meta.url).href;const r=new ae().load(n),c=new le;function m(v,h){v.children.length>0&&v.children.forEach(a=>{if(a.isMesh){const d=new de(Math.random(),Math.random(),Math.random()),g=new ue({uniforms:{uColor:{value:d},uTexture:{value:r},uTime:{value:0}},vertexShader:He,fragmentShader:Te,blending:he,transparent:!0,depthTest:!1}),s=new pe(a.geometry,g);s.position.copy(a.position),s.rotation.copy(a.rotation),s.scale.copy(a.scale),h.add(s),m(a,s)}})}return m(t,c),c}pointsBlast(){this.fighterPointsGroup.traverse(t=>{if(t.isPoints){let n=new Float32Array(t.geometry.attributes.position.count*3);for(let r=0;r<t.geometry.attributes.position.count;r++)n[r*3+0]=(Math.random()*2-1)*10,n[r*3+1]=(Math.random()*2-1)*10,n[r*3+2]=(Math.random()*2-1)*10;t.geometry.setAttribute("aPosition",new ce(n,3)),E.to(t.material.uniforms.uTime,{value:10,duration:5})}})}pointsBack(){this.fighterPointsGroup.traverse(t=>{t.isPoints&&E.to(t.material.uniforms.uTime,{value:0,duration:5})})}}let L;const Ue=()=>(L=new ze(C),L);function Ve(l){L.update(l)}const Ne=new me;function Y(l,t){let n=Ne.getDelta();Fe.controls.update(),l(n),requestAnimationFrame(()=>{Y(l)}),S.renderer.render(C,M.activeCamera),S.css3drender.render(C,M.activeCamera)}u.on("toggleCamera",()=>{});const qe={__name:"FactoryScene",setup(l){let t=O(null),n=O(null);return C.add(M.activeCamera),C.add(ve),Ue(),S.renderer.render(C,M.activeCamera),we(()=>{t.value.appendChild(S.renderer.domElement),t.value.appendChild(S.renderer.domElement),n.value.appendChild(S.css3drender.domElement),Y(Ve)}),(r,c)=>(R(),W(Ce,null,[o("div",{class:"scene",ref_key:"sceneDiv",ref:t},null,512),o("div",{class:"cssrender",ref_key:"cssrenderScene",ref:n},null,512)],64))}},p=l=>(Se("data-v-944fcb9d"),l=l(),Ae(),l),Ie={id:"bigScreen"},Xe=p(()=>o("div",{class:"header"},"超宇智慧工厂系统管理平台",-1)),Je={class:"main"},Ke={class:"right"},Qe=["src"],Ye=p(()=>o("span",null," 展开飞机 ",-1)),Ze=p(()=>o("div",{class:"footerBorder"},null,-1)),je=["src"],$e=p(()=>o("span",null," 恢复飞机 ",-1)),et=p(()=>o("div",{class:"footerBorder"},null,-1)),tt=["src"],st=p(()=>o("span",null," 粒子特效 ",-1)),nt=p(()=>o("div",{class:"footerBorder"},null,-1)),it=["src"],ot=p(()=>o("span",null," 粒子爆炸 ",-1)),rt=p(()=>o("div",{class:"footerBorder"},null,-1)),at=["src"],lt=p(()=>o("span",null," 粒子复原 ",-1)),ct=p(()=>o("div",{class:"footerBorder"},null,-1)),dt=["src"],ut=p(()=>o("span",null," 移除粒子 ",-1)),ht=p(()=>o("div",{class:"footerBorder"},null,-1)),pt={__name:"BigScreenFactory",setup(l){let t=new URL("/assets/bar-LCN0kkKR.svg",import.meta.url).href,n=O(null);u.on("spriteClick",d=>{n.value=d.i});const r=()=>{u.emit("flatFighter")},c=()=>{u.emit("recoverFighter")},m=()=>{u.emit("pointsFighter")},v=()=>{u.emit("pointsBlast")},h=()=>{u.emit("pointsBack")},a=()=>{u.emit("pointsRemove")};return(d,g)=>(R(),W("div",Ie,[Xe,o("div",Je,[o("div",Ke,[o("div",{class:"cityEvent",onClick:r},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,Qe),Ye]),Ze]),o("div",{class:"cityEvent",onClick:c},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,je),$e]),et]),o("div",{class:"cityEvent",onClick:m},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,tt),st]),nt]),o("div",{class:"cityEvent",onClick:v},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,it),ot]),rt]),o("div",{class:"cityEvent",onClick:h},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,at),lt]),ct]),o("div",{class:"cityEvent",onClick:a},[o("h3",null,[o("img",{class:"icon",src:A(t),alt:""},null,8,dt),ut]),ht])])])]))}},mt=xe(pt,[["__scopeId","data-v-944fcb9d"]]),At={__name:"Factory",setup(l){return(t,n)=>(R(),W("div",null,[U(qe),U(mt)]))}};export{At as default};
