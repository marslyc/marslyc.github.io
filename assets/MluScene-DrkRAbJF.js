import{p as le,af as W,c as S,V as T,q as se,Q as pe,W as de,L as me,z as ue,B as he,H as fe,w as ge,Z as ye,ad as K,M as J,Y as ae,ah as be,D as we,T as ie,ai as Ee,a as xe,S as Se,o as je,v as Oe,m as _e,n as ve,l as Me}from"./three.module-cau8k_-o.js";import{G as Te}from"./GLTFLoader-BlI6CtEi.js";import{_ as Le,r as U,o as Pe,c as ke,b as N,a as Ce}from"./index-XszStmJi.js";const $={type:"change"},ee={type:"start"},te={type:"end"};class ze extends le{constructor(Q,X){super();const e=this,a={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=Q,this.domElement=X,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:W.ROTATE,MIDDLE:W.DOLLY,RIGHT:W.PAN},this.target=new S;const q=1e-6,z=new S;let Z=1,g=a.NONE,y=a.NONE,P=0,I=0,F=0;const h=new S,j=new T,f=new T,V=new S,r=new T,k=new T,L=new T,O=new T,c=[],H={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const t=e.domElement.getBoundingClientRect(),o=e.domElement.ownerDocument.documentElement;e.screen.left=t.left+window.pageXOffset-o.clientLeft,e.screen.top=t.top+window.pageYOffset-o.clientTop,e.screen.width=t.width,e.screen.height=t.height};const _=function(){const t=new T;return function(u,x){return t.set((u-e.screen.left)/e.screen.width,(x-e.screen.top)/e.screen.height),t}}(),A=function(){const t=new T;return function(u,x){return t.set((u-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-x))/e.screen.width),t}}();this.rotateCamera=function(){const t=new S,o=new pe,u=new S,x=new S,C=new S,R=new S;return function(){R.set(f.x-j.x,f.y-j.y,0);let G=R.length();G?(h.copy(e.object.position).sub(e.target),u.copy(h).normalize(),x.copy(e.object.up).normalize(),C.crossVectors(x,u).normalize(),x.setLength(f.y-j.y),C.setLength(f.x-j.x),R.copy(x.add(C)),t.crossVectors(R,h).normalize(),G*=e.rotateSpeed,o.setFromAxisAngle(t,G),h.applyQuaternion(o),e.object.up.applyQuaternion(o),V.copy(t),F=G):!e.staticMoving&&F&&(F*=Math.sqrt(1-e.dynamicDampingFactor),h.copy(e.object.position).sub(e.target),o.setFromAxisAngle(V,F),h.applyQuaternion(o),e.object.up.applyQuaternion(o)),j.copy(f)}}(),this.zoomCamera=function(){let t;g===a.TOUCH_ZOOM_PAN?(t=P/I,P=I,e.object.isPerspectiveCamera?h.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=se.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),Z!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(t=1+(k.y-r.y)*e.zoomSpeed,t!==1&&t>0&&(e.object.isPerspectiveCamera?h.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=se.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),Z!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?r.copy(k):r.y+=(k.y-r.y)*this.dynamicDampingFactor)},this.panCamera=function(){const t=new T,o=new S,u=new S;return function(){if(t.copy(O).sub(L),t.lengthSq()){if(e.object.isOrthographicCamera){const C=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,R=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;t.x*=C,t.y*=R}t.multiplyScalar(h.length()*e.panSpeed),u.copy(h).cross(e.object.up).setLength(t.x),u.add(o.copy(e.object.up).setLength(t.y)),e.object.position.add(u),e.target.add(u),e.staticMoving?L.copy(O):L.add(t.subVectors(O,L).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(h.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,h.setLength(e.maxDistance)),r.copy(k)),h.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,h.setLength(e.minDistance)),r.copy(k)))},this.update=function(){h.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,h),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),z.distanceToSquared(e.object.position)>q&&(e.dispatchEvent($),z.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(z.distanceToSquared(e.object.position)>q||Z!==e.object.zoom)&&(e.dispatchEvent($),z.copy(e.object.position),Z=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){g=a.NONE,y=a.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),h.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent($),z.copy(e.object.position),Z=e.object.zoom};function B(t){e.enabled!==!1&&(c.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",s),e.domElement.addEventListener("pointerup",n)),Y(t),t.pointerType==="touch"?v(t):b(t))}function s(t){e.enabled!==!1&&(t.pointerType==="touch"?E(t):d(t))}function n(t){e.enabled!==!1&&(t.pointerType==="touch"?D(t):w(),oe(t),c.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",s),e.domElement.removeEventListener("pointerup",n)))}function l(t){oe(t)}function i(t){e.enabled!==!1&&(window.removeEventListener("keydown",i),y===a.NONE&&(t.code===e.keys[a.ROTATE]&&!e.noRotate?y=a.ROTATE:t.code===e.keys[a.ZOOM]&&!e.noZoom?y=a.ZOOM:t.code===e.keys[a.PAN]&&!e.noPan&&(y=a.PAN)))}function p(){e.enabled!==!1&&(y=a.NONE,window.addEventListener("keydown",i))}function b(t){if(g===a.NONE)switch(t.button){case e.mouseButtons.LEFT:g=a.ROTATE;break;case e.mouseButtons.MIDDLE:g=a.ZOOM;break;case e.mouseButtons.RIGHT:g=a.PAN;break}const o=y!==a.NONE?y:g;o===a.ROTATE&&!e.noRotate?(f.copy(A(t.pageX,t.pageY)),j.copy(f)):o===a.ZOOM&&!e.noZoom?(r.copy(_(t.pageX,t.pageY)),k.copy(r)):o===a.PAN&&!e.noPan&&(L.copy(_(t.pageX,t.pageY)),O.copy(L)),e.dispatchEvent(ee)}function d(t){const o=y!==a.NONE?y:g;o===a.ROTATE&&!e.noRotate?(j.copy(f),f.copy(A(t.pageX,t.pageY))):o===a.ZOOM&&!e.noZoom?k.copy(_(t.pageX,t.pageY)):o===a.PAN&&!e.noPan&&O.copy(_(t.pageX,t.pageY))}function w(){g=a.NONE,e.dispatchEvent(te)}function m(t){if(e.enabled!==!1&&e.noZoom!==!0){switch(t.preventDefault(),t.deltaMode){case 2:r.y-=t.deltaY*.025;break;case 1:r.y-=t.deltaY*.01;break;default:r.y-=t.deltaY*25e-5;break}e.dispatchEvent(ee),e.dispatchEvent(te)}}function v(t){switch(ne(t),c.length){case 1:g=a.TOUCH_ROTATE,f.copy(A(c[0].pageX,c[0].pageY)),j.copy(f);break;default:g=a.TOUCH_ZOOM_PAN;const o=c[0].pageX-c[1].pageX,u=c[0].pageY-c[1].pageY;I=P=Math.sqrt(o*o+u*u);const x=(c[0].pageX+c[1].pageX)/2,C=(c[0].pageY+c[1].pageY)/2;L.copy(_(x,C)),O.copy(L);break}e.dispatchEvent(ee)}function E(t){switch(ne(t),c.length){case 1:j.copy(f),f.copy(A(t.pageX,t.pageY));break;default:const o=re(t),u=t.pageX-o.x,x=t.pageY-o.y;I=Math.sqrt(u*u+x*x);const C=(t.pageX+o.x)/2,R=(t.pageY+o.y)/2;O.copy(_(C,R));break}}function D(t){switch(c.length){case 0:g=a.NONE;break;case 1:g=a.TOUCH_ROTATE,f.copy(A(t.pageX,t.pageY)),j.copy(f);break;case 2:g=a.TOUCH_ZOOM_PAN;for(let o=0;o<c.length;o++)if(c[o].pointerId!==t.pointerId){const u=H[c[o].pointerId];f.copy(A(u.x,u.y)),j.copy(f);break}break}e.dispatchEvent(te)}function M(t){e.enabled!==!1&&t.preventDefault()}function Y(t){c.push(t)}function oe(t){delete H[t.pointerId];for(let o=0;o<c.length;o++)if(c[o].pointerId==t.pointerId){c.splice(o,1);return}}function ne(t){let o=H[t.pointerId];o===void 0&&(o=new T,H[t.pointerId]=o),o.set(t.pageX,t.pageY)}function re(t){const o=t.pointerId===c[0].pointerId?c[1]:c[0];return H[o.pointerId]}this.dispose=function(){e.domElement.removeEventListener("contextmenu",M),e.domElement.removeEventListener("pointerdown",B),e.domElement.removeEventListener("pointercancel",l),e.domElement.removeEventListener("wheel",m),e.domElement.removeEventListener("pointermove",s),e.domElement.removeEventListener("pointerup",n),window.removeEventListener("keydown",i),window.removeEventListener("keyup",p)},this.domElement.addEventListener("contextmenu",M),this.domElement.addEventListener("pointerdown",B),this.domElement.addEventListener("pointercancel",l),this.domElement.addEventListener("wheel",m,{passive:!1}),window.addEventListener("keydown",i),window.addEventListener("keyup",p),this.handleResize(),this.update()}}const Ae={id:"bone",ref:"",class:"boxx"},De={class:"box-main"},Re={__name:"MluScene",setup(ce){let Q=U(null),X=U(null),e=U(null),a=U(null),q=U(null),z=U(null),Z=U(null);return Pe(()=>{let g=[],y=(s,n)=>{g.push({elem:s,fn:n})},P=s=>{let n=new Se,l=new je(45,2,.1,5);l.position.set(0,1,2),l.lookAt(0,0,0),n.add(l);let i=new ze(l,s);i.noZoom=!0,i.noPan=!0;let p=new Oe(.5);n.add(p);const b=16777215,d=1;let w=new _e(b,d);n.add(w);const m=new ve(b,d);return m.position.set(-1,2,4),l.add(m),{scene:n,camera:l,elem:s,controls:i}},I=()=>{let{scene:s,camera:n,elem:l,controls:i}=P(X.value);const p=new me({linewidth:2,vertexColors:!0});let d=new ue(new S(.5,.5,0),new S(-.5,-1,0),new S(1,-.5,0)).getPoints(3),w=[];d.forEach(M=>{w.push(M.x,M.y,M.z)});const m=new he().setFromPoints(d);let v=[1,0,0,0,1,0,0,0,1,1,1,0],E=new fe(v,3);m.setAttribute("color",E);const D=new ge(m,p);s.add(D),y(l,(M,Y)=>{n.aspect=Y.width/Y.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),r.render(s,n)})},F=()=>{let{scene:s,camera:n,elem:l,controls:i}=P(e.value);const p=new ye(.5,.5,.5),b=new K({color:"red"}),d=new J(p,b);s.add(d),y(l,(w,m)=>{n.aspect=m.width/m.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),d.rotation.y+=.01,r.render(s,n)})},h=()=>{let{scene:s,camera:n,elem:l,controls:i}=P(a.value);const p=new ae(.5,7,4,.8,Math.PI),b=new be({wireframe:!0,color:255,side:we}),d=new J(p,b);d.position.set(0,0,0),s.add(d),y(l,(w,m)=>{n.aspect=m.width/m.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),r.render(s,n)})},j=()=>{let{scene:s,camera:n,elem:l,controls:i}=P(q.value),p=new URL("/assets/earth_atmos_2048-d1pdJ3jg.jpg",import.meta.url).href,b=new URL("/assets/earth_specular_2048-6aAFN27D.jpg",import.meta.url).href,d=new URL("/assets/earth_normal_2048-BD2vMuPH.jpg",import.meta.url).href,w=new ie;const m=new ae(.5,32,32),v=new K({specular:3355443,shininess:5,map:w.load(p),specularMap:w.load(b),normalMap:w.load(d),normalScale:new T(.85,.85)});let E=new J(m,v);s.add(E),y(l,(D,M)=>{n.aspect=M.width/M.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),E.rotation.y+=.01,r.render(s,n)})},f=()=>{let{scene:s,camera:n,elem:l,controls:i}=P(z.value);n.position.set(2,1,0);const p=new ie;let b=new URL("/assets/050-0KLaPgHm.jpg",import.meta.url).href;const d=p.load(b);d.mapping=Ee,s.background=d,s.environment=d;const w=new Te;let m=new URL("/assets/lion-C8oH2N95.gltf",import.meta.url).href;w.load(m,v=>{const E=v.scene.children[0];E.material=new K({color:16777215,envMap:d,refractionRatio:.7,reflectivity:.99}),s.add(E)}),y(l,(v,E)=>{n.aspect=E.width/E.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),r.render(s,n)})};const V=document.querySelector("#c");let r=new de({antialias:!0,canvas:V,alpha:!0}),k=s=>{const n=s.domElement,l=n.clientWidth,i=n.clientHeight,p=n.width!==l||n.height!==i;return p&&s.setSize(l,i,!1),p},L=new Me;I(),F(),h(),j(),f();let O=document.querySelector(".boxx"),c=O.scrollHeight-O.clientHeight,H=()=>{let s=document.querySelector(".boxx");c=s.scrollHeight-s.clientHeight};window.addEventListener("resize",H);let _=0,A=s=>{if(_=s.target.scrollTop,_<c){let l=document.querySelector(".box-main").clientHeight;const i=`translateY(${_}px)`;let p=document.querySelector("#c");p.style.position="absolute",p.style.transform=i,p.style.height=l-_+"px"}};O.addEventListener("scroll",A);let B=()=>{let s=L.getDelta();k(r);let n=new xe(16777215);r.setScissorTest(!1),r.setClearColor(n,0),r.clear(!0,!0),r.setScissorTest(!0);for(let{elem:l,fn:i}of g){const p=l.getBoundingClientRect(),{left:b,right:d,top:w,bottom:m,width:v,height:E}=p;let D=b-180;if(!(m<0||w>r.domElement.clientHeight||d<0||D>r.domElement.clientWidth)){const Y=r.domElement.clientHeight-m;r.setScissor(D,Y,v,E),r.setViewport(D,Y,v,E),i(s,p)}}requestAnimationFrame(B)};B()}),(g,y)=>(Ce(),ke("div",Ae,[N("div",De,[N("canvas",{id:"c",class:"box-c",ref_key:"canvasScene",ref:Q},null,512),N("div",{ref_key:"colorScene",ref:X,class:"box-color"},"顶点颜色渲染",512),N("div",{ref_key:"carScene",ref:e,class:"box-car"},"网格模型",512),N("div",{ref_key:"sphereScene",ref:a,class:"box-bone"},"球缓冲体",512),N("div",{ref_key:"b1Scene",ref:q,class:"box-bone"},"纹理贴图",512),N("div",{ref_key:"b2Scene",ref:z,class:"box-bone"},"模型加载",512),N("div",{ref_key:"b3Scene",ref:Z,class:"box-bone"},"自定义",512)])],512))}},Ue=Le(Re,[["__scopeId","data-v-ea93b019"]]);export{Ue as default};
