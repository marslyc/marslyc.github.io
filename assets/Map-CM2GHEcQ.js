import{S as it,r as rt,v as ot,q as lt,p as ut,W as ft,O as An,F as at,B as Dn,c as b,a as Nn,L as In,w as Bn,x as ct,y as st,k as pt,M as ht,z as vt,D as gt,R as dt}from"./three.module-A37dimS0.js";import{O as wt}from"./OrbitControls-zRnuQD7T.js";import{C as St,a as Et}from"./CSS2DRenderer-C0mfPR3_.js";import{r as yt,o as mt,f as Mt,c as Pt,a as Rt}from"./index-_YfaVgSB.js";class Lt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const a=i[r],c=t+a,s=Math.abs(t)<Math.abs(a)?t-(c-a):a-(c-t);s&&(i[e++]=s),t=c}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,r,a,c=0;if(i>0){for(c=t[--i];i>0&&(e=c,r=t[--i],c=e+r,a=r-(c-e),!a););i>0&&(a<0&&t[i-1]<0||a>0&&t[i-1]>0)&&(r=a*2,e=c+r,r==e-c&&(c=e))}return c}}function*Ct(n){for(const t of n)yield*t}function $n(n){return Array.from(Ct(n))}var T=1e-6,xt=1e-12,N=Math.PI,J=N/2,Hn=N/4,V=N*2,Q=180/N,U=N/180,W=Math.abs,Kn=Math.atan,en=Math.atan2,_=Math.cos,zt=Math.exp,At=Math.log,q=Math.sin,Dt=Math.sign||function(n){return n>0?1:n<0?-1:0},dn=Math.sqrt,Nt=Math.tan;function It(n){return n>1?0:n<-1?N:Math.acos(n)}function rn(n){return n>1?J:n<-1?-J:Math.asin(n)}function nn(){}function pn(n,t){n&&Tn.hasOwnProperty(n.type)&&Tn[n.type](n,t)}var On={Feature:function(n,t){pn(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,r=i.length;++e<r;)pn(i[e].geometry,t)}},Tn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){yn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)yn(i[e],t,0)},Polygon:function(n,t){Wn(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Wn(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,r=i.length;++e<r;)pn(i[e],t)}};function yn(n,t,i){var e=-1,r=n.length-i,a;for(t.lineStart();++e<r;)a=n[e],t.point(a[0],a[1],a[2]);t.lineEnd()}function Wn(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)yn(n[i],t,1);t.polygonEnd()}function Bt(n,t){n&&On.hasOwnProperty(n.type)?On[n.type](n,t):pn(n,t)}function mn(n){return[en(n[1],n[0]),rn(n[2])]}function Z(n){var t=n[0],i=n[1],e=_(i);return[e*_(t),e*q(t),q(i)]}function un(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function hn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Sn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function fn(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Mn(n){var t=dn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Pn(n,t){function i(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(i.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),i}function Rn(n,t){return W(n)>N&&(n-=Math.round(n/V)*V),[n,t]}Rn.invert=Rn;function Zn(n,t,i){return(n%=V)?t||i?Pn(_n(n),qn(t,i)):_n(n):t||i?qn(t,i):Rn}function Fn(n){return function(t,i){return t+=n,W(t)>N&&(t-=Math.round(t/V)*V),[t,i]}}function _n(n){var t=Fn(n);return t.invert=Fn(-n),t}function qn(n,t){var i=_(n),e=q(n),r=_(t),a=q(t);function c(s,g){var h=_(g),o=_(s)*h,u=q(s)*h,f=q(g),v=f*i+o*e;return[en(u*r-v*a,o*i-f*e),rn(v*r+u*a)]}return c.invert=function(s,g){var h=_(g),o=_(s)*h,u=q(s)*h,f=q(g),v=f*r-u*a;return[en(u*r+f*a,o*i+v*e),rn(v*i-o*e)]},c}function Ht(n){n=Zn(n[0]*U,n[1]*U,n.length>2?n[2]*U:0);function t(i){return i=n(i[0]*U,i[1]*U),i[0]*=Q,i[1]*=Q,i}return t.invert=function(i){return i=n.invert(i[0]*U,i[1]*U),i[0]*=Q,i[1]*=Q,i},t}function Ot(n,t,i,e,r,a){if(i){var c=_(t),s=q(t),g=e*i;r==null?(r=t+e*V,a=t-g/2):(r=Gn(c,r),a=Gn(c,a),(e>0?r<a:r>a)&&(r+=e*V));for(var h,o=r;e>0?o>a:o<a;o-=g)h=mn([c,-s*_(o),-s*q(o)]),n.point(h[0],h[1])}}function Gn(n,t){t=Z(t),t[0]-=n,Mn(t);var i=It(-t[1]);return((-t[2]<0?-i:i)+V-T)%V}function kn(){var n=[],t;return{point:function(i,e,r){t.push([i,e,r])},lineStart:function(){n.push(t=[])},lineEnd:nn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],t=null,i}}}function sn(n,t){return W(n[0]-t[0])<T&&W(n[1]-t[1])<T}function an(n,t,i,e){this.x=n,this.z=t,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function bn(n,t,i,e,r){var a=[],c=[],s,g;if(n.forEach(function(p){if(!((M=p.length-1)<=0)){var M,S=p[0],z=p[M],E;if(sn(S,z)){if(!S[2]&&!z[2]){for(r.lineStart(),s=0;s<M;++s)r.point((S=p[s])[0],S[1]);r.lineEnd();return}z[0]+=2*T}a.push(E=new an(S,p,null,!0)),c.push(E.o=new an(S,null,E,!1)),a.push(E=new an(z,p,null,!1)),c.push(E.o=new an(z,null,E,!0))}}),!!a.length){for(c.sort(t),Un(a),Un(c),s=0,g=c.length;s<g;++s)c[s].e=i=!i;for(var h=a[0],o,u;;){for(var f=h,v=!0;f.v;)if((f=f.n)===h)return;o=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(v)for(s=0,g=o.length;s<g;++s)r.point((u=o[s])[0],u[1]);else e(f.x,f.n.x,1,r);f=f.n}else{if(v)for(o=f.p.z,s=o.length-1;s>=0;--s)r.point((u=o[s])[0],u[1]);else e(f.x,f.p.x,-1,r);f=f.p}f=f.o,o=f.z,v=!v}while(!f.v);r.lineEnd()}}}function Un(n){if(t=n.length){for(var t,i=0,e=n[0],r;++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function En(n){return W(n[0])<=N?n[0]:Dt(n[0])*((W(n[0])+N)%V-N)}function Tt(n,t){var i=En(t),e=t[1],r=q(e),a=[q(i),-_(i),0],c=0,s=0,g=new Lt;r===1?e=J+T:r===-1&&(e=-J-T);for(var h=0,o=n.length;h<o;++h)if(f=(u=n[h]).length)for(var u,f,v=u[f-1],p=En(v),M=v[1]/2+Hn,S=q(M),z=_(M),E=0;E<f;++E,p=w,S=y,z=B,v=L){var L=u[E],w=En(L),P=L[1]/2+Hn,y=q(P),B=_(P),D=w-p,I=D>=0?1:-1,H=I*D,m=H>N,Y=S*y;if(g.add(en(Y*I*q(H),z*B+Y*_(H))),c+=m?D+I*V:D,m^p>=i^w>=i){var C=hn(Z(v),Z(L));Mn(C);var R=hn(a,C);Mn(R);var l=(m^D>=0?-1:1)*rn(R[2]);(e>l||e===l&&(C[0]||C[1]))&&(s+=m^D>=0?1:-1)}}return(c<-T||c<T&&g<-xt)^s&1}function nt(n,t,i,e){return function(r){var a=t(r),c=kn(),s=t(c),g=!1,h,o,u,f={point:v,lineStart:M,lineEnd:S,polygonStart:function(){f.point=z,f.lineStart=E,f.lineEnd=L,o=[],h=[]},polygonEnd:function(){f.point=v,f.lineStart=M,f.lineEnd=S,o=$n(o);var w=Tt(h,e);o.length?(g||(r.polygonStart(),g=!0),bn(o,Ft,w,i,r)):w&&(g||(r.polygonStart(),g=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),g&&(r.polygonEnd(),g=!1),o=h=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function v(w,P){n(w,P)&&r.point(w,P)}function p(w,P){a.point(w,P)}function M(){f.point=p,a.lineStart()}function S(){f.point=v,a.lineEnd()}function z(w,P){u.push([w,P]),s.point(w,P)}function E(){s.lineStart(),u=[]}function L(){z(u[0][0],u[0][1]),s.lineEnd();var w=s.clean(),P=c.result(),y,B=P.length,D,I,H;if(u.pop(),h.push(u),u=null,!!B){if(w&1){if(I=P[0],(D=I.length-1)>0){for(g||(r.polygonStart(),g=!0),r.lineStart(),y=0;y<D;++y)r.point((H=I[y])[0],H[1]);r.lineEnd()}return}B>1&&w&2&&P.push(P.pop().concat(P.shift())),o.push(P.filter(Wt))}}return f}}function Wt(n){return n.length>1}function Ft(n,t){return((n=n.x)[0]<0?n[1]-J-T:J-n[1])-((t=t.x)[0]<0?t[1]-J-T:J-t[1])}const Xn=nt(function(){return!0},_t,Gt,[-N,-J]);function _t(n){var t=NaN,i=NaN,e=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(a,c){var s=a>0?N:-N,g=W(a-t);W(g-N)<T?(n.point(t,i=(i+c)/2>0?J:-J),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),n.point(a,i),r=0):e!==s&&g>=N&&(W(t-e)<T&&(t-=e*T),W(a-s)<T&&(a-=s*T),i=qt(t,i,a,c),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),r=0),n.point(t=a,i=c),e=s},lineEnd:function(){n.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function qt(n,t,i,e){var r,a,c=q(n-i);return W(c)>T?Kn((q(t)*(a=_(e))*q(i)-q(e)*(r=_(t))*q(n))/(r*a*c)):(t+e)/2}function Gt(n,t,i,e){var r;if(n==null)r=i*J,e.point(-N,r),e.point(0,r),e.point(N,r),e.point(N,0),e.point(N,-r),e.point(0,-r),e.point(-N,-r),e.point(-N,0),e.point(-N,r);else if(W(n[0]-t[0])>T){var a=n[0]<t[0]?N:-N;r=i*a/2,e.point(-a,r),e.point(0,r),e.point(a,r)}else e.point(t[0],t[1])}function Ut(n){var t=_(n),i=2*U,e=t>0,r=W(t)>T;function a(o,u,f,v){Ot(v,n,i,f,o,u)}function c(o,u){return _(o)*_(u)>t}function s(o){var u,f,v,p,M;return{lineStart:function(){p=v=!1,M=1},point:function(S,z){var E=[S,z],L,w=c(S,z),P=e?w?0:h(S,z):w?h(S+(S<0?N:-N),z):0;if(!u&&(p=v=w)&&o.lineStart(),w!==v&&(L=g(u,E),(!L||sn(u,L)||sn(E,L))&&(E[2]=1)),w!==v)M=0,w?(o.lineStart(),L=g(E,u),o.point(L[0],L[1])):(L=g(u,E),o.point(L[0],L[1],2),o.lineEnd()),u=L;else if(r&&u&&e^w){var y;!(P&f)&&(y=g(E,u,!0))&&(M=0,e?(o.lineStart(),o.point(y[0][0],y[0][1]),o.point(y[1][0],y[1][1]),o.lineEnd()):(o.point(y[1][0],y[1][1]),o.lineEnd(),o.lineStart(),o.point(y[0][0],y[0][1],3)))}w&&(!u||!sn(u,E))&&o.point(E[0],E[1]),u=E,v=w,f=P},lineEnd:function(){v&&o.lineEnd(),u=null},clean:function(){return M|(p&&v)<<1}}}function g(o,u,f){var v=Z(o),p=Z(u),M=[1,0,0],S=hn(v,p),z=un(S,S),E=S[0],L=z-E*E;if(!L)return!f&&o;var w=t*z/L,P=-t*E/L,y=hn(M,S),B=fn(M,w),D=fn(S,P);Sn(B,D);var I=y,H=un(B,I),m=un(I,I),Y=H*H-m*(un(B,B)-1);if(!(Y<0)){var C=dn(Y),R=fn(I,(-H-C)/m);if(Sn(R,B),R=mn(R),!f)return R;var l=o[0],d=u[0],A=o[1],x=u[1],O;d<l&&(O=l,l=d,d=O);var j=d-l,G=W(j-N)<T,F=G||j<T;if(!G&&x<A&&(O=A,A=x,x=O),F?G?A+x>0^R[1]<(W(R[0]-l)<T?A:x):A<=R[1]&&R[1]<=x:j>N^(l<=R[0]&&R[0]<=d)){var X=fn(I,(-H+C)/m);return Sn(X,B),[R,mn(X)]}}}function h(o,u){var f=e?n:N-n,v=0;return o<-f?v|=1:o>f&&(v|=2),u<-f?v|=4:u>f&&(v|=8),v}return nt(c,s,a,e?[0,-n]:[-N,n-N])}function Xt(n,t,i,e,r,a){var c=n[0],s=n[1],g=t[0],h=t[1],o=0,u=1,f=g-c,v=h-s,p;if(p=i-c,!(!f&&p>0)){if(p/=f,f<0){if(p<o)return;p<u&&(u=p)}else if(f>0){if(p>u)return;p>o&&(o=p)}if(p=r-c,!(!f&&p<0)){if(p/=f,f<0){if(p>u)return;p>o&&(o=p)}else if(f>0){if(p<o)return;p<u&&(u=p)}if(p=e-s,!(!v&&p>0)){if(p/=v,v<0){if(p<o)return;p<u&&(u=p)}else if(v>0){if(p>u)return;p>o&&(o=p)}if(p=a-s,!(!v&&p<0)){if(p/=v,v<0){if(p>u)return;p>o&&(o=p)}else if(v>0){if(p<o)return;p<u&&(u=p)}return o>0&&(n[0]=c+o*f,n[1]=s+o*v),u<1&&(t[0]=c+u*f,t[1]=s+u*v),!0}}}}}var tn=1e9,cn=-tn;function Yt(n,t,i,e){function r(h,o){return n<=h&&h<=i&&t<=o&&o<=e}function a(h,o,u,f){var v=0,p=0;if(h==null||(v=c(h,u))!==(p=c(o,u))||g(h,o)<0^u>0)do f.point(v===0||v===3?n:i,v>1?e:t);while((v=(v+u+4)%4)!==p);else f.point(o[0],o[1])}function c(h,o){return W(h[0]-n)<T?o>0?0:3:W(h[0]-i)<T?o>0?2:1:W(h[1]-t)<T?o>0?1:0:o>0?3:2}function s(h,o){return g(h.x,o.x)}function g(h,o){var u=c(h,1),f=c(o,1);return u!==f?u-f:u===0?o[1]-h[1]:u===1?h[0]-o[0]:u===2?h[1]-o[1]:o[0]-h[0]}return function(h){var o=h,u=kn(),f,v,p,M,S,z,E,L,w,P,y,B={point:D,lineStart:Y,lineEnd:C,polygonStart:H,polygonEnd:m};function D(l,d){r(l,d)&&o.point(l,d)}function I(){for(var l=0,d=0,A=v.length;d<A;++d)for(var x=v[d],O=1,j=x.length,G=x[0],F,X,$=G[0],K=G[1];O<j;++O)F=$,X=K,G=x[O],$=G[0],K=G[1],X<=e?K>e&&($-F)*(e-X)>(K-X)*(n-F)&&++l:K<=e&&($-F)*(e-X)<(K-X)*(n-F)&&--l;return l}function H(){o=u,f=[],v=[],y=!0}function m(){var l=I(),d=y&&l,A=(f=$n(f)).length;(d||A)&&(h.polygonStart(),d&&(h.lineStart(),a(null,null,1,h),h.lineEnd()),A&&bn(f,s,l,a,h),h.polygonEnd()),o=h,f=v=p=null}function Y(){B.point=R,v&&v.push(p=[]),P=!0,w=!1,E=L=NaN}function C(){f&&(R(M,S),z&&w&&u.rejoin(),f.push(u.result())),B.point=D,w&&o.lineEnd()}function R(l,d){var A=r(l,d);if(v&&p.push([l,d]),P)M=l,S=d,z=A,P=!1,A&&(o.lineStart(),o.point(l,d));else if(A&&w)o.point(l,d);else{var x=[E=Math.max(cn,Math.min(tn,E)),L=Math.max(cn,Math.min(tn,L))],O=[l=Math.max(cn,Math.min(tn,l)),d=Math.max(cn,Math.min(tn,d))];Xt(x,O,n,t,i,e)?(w||(o.lineStart(),o.point(x[0],x[1])),o.point(O[0],O[1]),A||o.lineEnd(),y=!1):A&&(o.lineStart(),o.point(l,d),y=!1)}E=l,L=d,w=A}return B}}const Yn=n=>n;var k=1/0,vn=k,on=-k,gn=on,jn={point:jt,lineStart:nn,lineEnd:nn,polygonStart:nn,polygonEnd:nn,result:function(){var n=[[k,vn],[on,gn]];return on=gn=-(vn=k=1/0),n}};function jt(n,t){n<k&&(k=n),n>on&&(on=n),t<vn&&(vn=t),t>gn&&(gn=t)}function Cn(n){return function(t){var i=new Ln;for(var e in n)i[e]=n[e];return i.stream=t,i}}function Ln(){}Ln.prototype={constructor:Ln,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function xn(n,t,i){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Bt(i,n.stream(jn)),t(jn.result()),e!=null&&n.clipExtent(e),n}function tt(n,t,i){return xn(n,function(e){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],c=Math.min(r/(e[1][0]-e[0][0]),a/(e[1][1]-e[0][1])),s=+t[0][0]+(r-c*(e[1][0]+e[0][0]))/2,g=+t[0][1]+(a-c*(e[1][1]+e[0][1]))/2;n.scale(150*c).translate([s,g])},i)}function Jt(n,t,i){return tt(n,[[0,0],t],i)}function Qt(n,t,i){return xn(n,function(e){var r=+t,a=r/(e[1][0]-e[0][0]),c=(r-a*(e[1][0]+e[0][0]))/2,s=-a*e[0][1];n.scale(150*a).translate([c,s])},i)}function Vt(n,t,i){return xn(n,function(e){var r=+t,a=r/(e[1][1]-e[0][1]),c=-a*e[0][0],s=(r-a*(e[1][1]+e[0][1]))/2;n.scale(150*a).translate([c,s])},i)}var Jn=16,$t=_(30*U);function Qn(n,t){return+t?Zt(n,t):Kt(n)}function Kt(n){return Cn({point:function(t,i){t=n(t,i),this.stream.point(t[0],t[1])}})}function Zt(n,t){function i(e,r,a,c,s,g,h,o,u,f,v,p,M,S){var z=h-e,E=o-r,L=z*z+E*E;if(L>4*t&&M--){var w=c+f,P=s+v,y=g+p,B=dn(w*w+P*P+y*y),D=rn(y/=B),I=W(W(y)-1)<T||W(a-u)<T?(a+u)/2:en(P,w),H=n(I,D),m=H[0],Y=H[1],C=m-e,R=Y-r,l=E*C-z*R;(l*l/L>t||W((z*C+E*R)/L-.5)>.3||c*f+s*v+g*p<$t)&&(i(e,r,a,c,s,g,m,Y,I,w/=B,P/=B,y,M,S),S.point(m,Y),i(m,Y,I,w,P,y,h,o,u,f,v,p,M,S))}}return function(e){var r,a,c,s,g,h,o,u,f,v,p,M,S={point:z,lineStart:E,lineEnd:w,polygonStart:function(){e.polygonStart(),S.lineStart=P},polygonEnd:function(){e.polygonEnd(),S.lineStart=E}};function z(D,I){D=n(D,I),e.point(D[0],D[1])}function E(){u=NaN,S.point=L,e.lineStart()}function L(D,I){var H=Z([D,I]),m=n(D,I);i(u,f,o,v,p,M,u=m[0],f=m[1],o=D,v=H[0],p=H[1],M=H[2],Jn,e),e.point(u,f)}function w(){S.point=z,e.lineEnd()}function P(){E(),S.point=y,S.lineEnd=B}function y(D,I){L(r=D,I),a=u,c=f,s=v,g=p,h=M,S.point=L}function B(){i(u,f,o,v,p,M,a,c,r,s,g,h,Jn,e),S.lineEnd=w,w()}return S}}var kt=Cn({point:function(n,t){this.stream.point(n*U,t*U)}});function bt(n){return Cn({point:function(t,i){var e=n(t,i);return this.stream.point(e[0],e[1])}})}function ne(n,t,i,e,r){function a(c,s){return c*=e,s*=r,[t+n*c,i-n*s]}return a.invert=function(c,s){return[(c-t)/n*e,(i-s)/n*r]},a}function Vn(n,t,i,e,r,a){if(!a)return ne(n,t,i,e,r);var c=_(a),s=q(a),g=c*n,h=s*n,o=c/n,u=s/n,f=(s*i-c*t)/n,v=(s*t+c*i)/n;function p(M,S){return M*=e,S*=r,[g*M-h*S+t,i-h*M-g*S]}return p.invert=function(M,S){return[e*(o*M-u*S+f),r*(v-u*M-o*S)]},p}function te(n){return ee(function(){return n})()}function ee(n){var t,i=150,e=480,r=250,a=0,c=0,s=0,g=0,h=0,o,u=0,f=1,v=1,p=null,M=Xn,S=null,z,E,L,w=Yn,P=.5,y,B,D,I,H;function m(l){return D(l[0]*U,l[1]*U)}function Y(l){return l=D.invert(l[0],l[1]),l&&[l[0]*Q,l[1]*Q]}m.stream=function(l){return I&&H===l?I:I=kt(bt(o)(M(y(w(H=l)))))},m.preclip=function(l){return arguments.length?(M=l,p=void 0,R()):M},m.postclip=function(l){return arguments.length?(w=l,S=z=E=L=null,R()):w},m.clipAngle=function(l){return arguments.length?(M=+l?Ut(p=l*U):(p=null,Xn),R()):p*Q},m.clipExtent=function(l){return arguments.length?(w=l==null?(S=z=E=L=null,Yn):Yt(S=+l[0][0],z=+l[0][1],E=+l[1][0],L=+l[1][1]),R()):S==null?null:[[S,z],[E,L]]},m.scale=function(l){return arguments.length?(i=+l,C()):i},m.translate=function(l){return arguments.length?(e=+l[0],r=+l[1],C()):[e,r]},m.center=function(l){return arguments.length?(a=l[0]%360*U,c=l[1]%360*U,C()):[a*Q,c*Q]},m.rotate=function(l){return arguments.length?(s=l[0]%360*U,g=l[1]%360*U,h=l.length>2?l[2]%360*U:0,C()):[s*Q,g*Q,h*Q]},m.angle=function(l){return arguments.length?(u=l%360*U,C()):u*Q},m.reflectX=function(l){return arguments.length?(f=l?-1:1,C()):f<0},m.reflectY=function(l){return arguments.length?(v=l?-1:1,C()):v<0},m.precision=function(l){return arguments.length?(y=Qn(B,P=l*l),R()):dn(P)},m.fitExtent=function(l,d){return tt(m,l,d)},m.fitSize=function(l,d){return Jt(m,l,d)},m.fitWidth=function(l,d){return Qt(m,l,d)},m.fitHeight=function(l,d){return Vt(m,l,d)};function C(){var l=Vn(i,0,0,f,v,u).apply(null,t(a,c)),d=Vn(i,e-l[0],r-l[1],f,v,u);return o=Zn(s,g,h),B=Pn(t,d),D=Pn(o,B),y=Qn(B,P),R()}function R(){return I=H=null,m}return function(){return t=n.apply(this,arguments),m.invert=t.invert&&Y,C()}}function zn(n,t){return[n,At(Nt((J+t)/2))]}zn.invert=function(n,t){return[n,2*Kn(zt(t))-J]};function ie(){return re(zn).scale(961/V)}function re(n){var t=te(n),i=t.center,e=t.scale,r=t.translate,a=t.clipExtent,c=null,s,g,h;t.scale=function(u){return arguments.length?(e(u),o()):e()},t.translate=function(u){return arguments.length?(r(u),o()):r()},t.center=function(u){return arguments.length?(i(u),o()):i()},t.clipExtent=function(u){return arguments.length?(u==null?c=s=g=h=null:(c=+u[0][0],s=+u[0][1],g=+u[1][0],h=+u[1][1]),o()):c==null?null:[[c,s],[g,h]]};function o(){var u=N*e(),f=t(Ht(t.rotate()).invert([0,0]));return a(c==null?[[f[0]-u,f[1]-u],[f[0]+u,f[1]+u]]:n===zn?[[Math.max(f[0]-u,c),s],[Math.min(f[0]+u,g),h]]:[[c,Math.max(f[1]-u,s)],[g,Math.min(f[1]+u,h)]])}return o()}const ce={__name:"Map",setup(n){let t=yt(),i=new it,e=new rt(90,window.innerWidth/window.innerHeight,.1,1e5);e.position.set(0,0,100),e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),i.add(e);let r=new ot(5);i.add(r);let a=new lt(16777215,1);i.add(a);const c=new ut(16777215,.5);i.add(c);let s=new ft;s.setSize(window.innerWidth,window.innerHeight);let g=new An,h=ie().center([116.402,39.915]).translate([0,0,0]),o=new at,u=new URL("/assets/map-BqTUXMPq.json",import.meta.url).href;o.load(u,C=>{let R=JSON.parse(C);v(R)});let f=[],v=C=>{C.features.forEach(l=>{let d=new An;d.name=l.properties.name;let A=l.properties.centroid||l.properties.center,x=S(A,l.properties.name);A&&f.push(A),x&&d.add(x);let O=l.geometry.coordinates,j="#99ff99";l.geometry.type==="MultiPolygon"&&O.forEach(G=>{G.forEach(F=>{let X=p(F,j,h),$=M(F,j,h);$.properties=l.properties.name,d.add(X),d.add($)})}),l.geometry.type==="Polygon"&&O.forEach(G=>{let F=p(G,j,h),X=M(G,j,h);X.properties=l.properties.name,d.add(F),d.add(X)}),g.add(d)}),i.add(g),L(f)},p=(C,R,l)=>{let d=new Dn,A=new Array;C.forEach(j=>{let[G,F]=l(j);A.push(new b(G,-F,3))}),d.setFromPoints(A);let x=new Nn(Math.random()*.5+.5,Math.random()*.5+.5,Math.random()*.5+.5),O=new In({color:x});return new Bn(d,O)},M=(C,R,l)=>{let d=new ct;C.forEach((j,G)=>{let[F,X]=l(j);G===0&&d.moveTo(F,-X),d.lineTo(F,-X)});let A=new st(d,{depth:3,bevelEnabled:!1}),x=(Math.random()*.5+.5)*16777215,O=new pt({color:x,transparent:!0,opacity:.5});return new ht(A,O)},S=(C,R)=>{if(C){let[l,d]=h(C),A=new b(l*1,-d*1,3),x=document.createElement("div");x.style.color="#ffffff",x.style.fontSize="12px",x.style.textShadow="1px 1px 2px #047cd6",x.className="map-label",x.innerHTML=R;let O=new St(x);return O.scale.set(.01,.01,.01),O.position.copy(A),O}},z=[],E=8,L=C=>{let R=C.length,l=C,d=l[0],A=[];for(;A.length<E*2;){let x=Math.floor(Math.random()*R);l[x]&&(A.push(l[x]),A.push(d),l.splice(x,1))}for(let x=0;x<A.length;x+=2){let[O,j]=h([A[x][0],A[x][1]]),G=new b(O,-j,5),[F,X]=h([A[x+1][0],A[x+1][1]]),$=new b(F,-X,5),K=new b((O+F)/2,(-j+-F)/2,15),wn=new vt(G,K,$).getPoints(10),ln=new Dn().setFromPoints(wn);ln.vertices=wn,ln.colors=new Array(wn.length).fill(new Nn("#00ff00")),z.push(ln);let et=new Bn(ln,new In({vertexColors:void 0,transparent:!0,side:gt,opacity:.8,linewidth:10,color:65280}));i.add(et)}return z},w=new Et;w.setSize(window.innerWidth,window.innerHeight),w.domElement.style.position="absolute",w.domElement.style.left="0px",w.domElement.style.top="0px";let P,y=null,B=null,D=C=>{let R=I(C),l=new dt;l.setFromCamera(R,e);let d=l.intersectObjects([g],!0);d.length>0?(y&&y.object.properties!==d[0].object.properties&&(y.object.material.color.set(B),y=null),d[0].object.properties&&(B=d[0].object.material.color.clone(),d[0].object.material.color.set("red")),y=d[0]):y&&y.object.properties&&(y.object.material.color.set(B),y=null)};window.addEventListener("click",D);let I=C=>{let R={x:0,y:0},l=P.getBoundingClientRect(),d={x:(C.clientX-l.left)*l.width/l.width,y:(C.clientY-l.top)*l.height/l.height};return R.x=d.x/P.width*2-1,R.y=-(d.y/P.height)*2+1,R},H=new wt(e,w.domElement);H.enableDamping=!0;let m=()=>{H.update(),requestAnimationFrame(m),s.render(i,e),w.render(i,e)};m();let Y=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),w.setSize(window.innerWidth,window.innerHeight),s.setSize(window.innerWidth,window.innerHeight),s.setPixelRatio(window.devicePixelRatio)};return window.addEventListener("resize",Y),mt(()=>{t.value.appendChild(s.domElement),t.value.appendChild(w.domElement),P=s.domElement}),Mt(()=>{window.removeEventListener("resize",Y),window.removeEventListener("click",D)}),(C,R)=>(Rt(),Pt("div",{id:"map",class:"mapScene",ref_key:"mapScene",ref:t},null,512))}};export{ce as default};
