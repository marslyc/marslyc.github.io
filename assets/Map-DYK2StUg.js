import{S as at,o as ct,n as st,m as pt,W as ht,O as Bn,F as vt,B as Tn,c as tn,a as gt,L as Hn,w as On,x as dt,y as wt,k as St,M as Et,z as mt,H as Fn,D as yt,R as Mt}from"./three.module-cau8k_-o.js";import{O as Pt}from"./OrbitControls-ZEAjEvOY.js";import{C as Rt,a as Lt}from"./CSS2DRenderer-D0EWFJgJ.js";import{r as Ct,o as At,f as zt,c as Dt,a as xt}from"./index-XszStmJi.js";class Nt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const a=i[r],f=t+a,s=Math.abs(t)<Math.abs(a)?t-(f-a):a-(f-t);s&&(i[e++]=s),t=f}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,r,a,f=0;if(i>0){for(f=t[--i];i>0&&(e=f,r=t[--i],f=e+r,a=r-(f-e),!a););i>0&&(a<0&&t[i-1]<0||a>0&&t[i-1]>0)&&(r=a*2,e=f+r,r==e-f&&(f=e))}return f}}function*It(n){for(const t of n)yield*t}function bn(n){return Array.from(It(n))}var F=1e-6,Bt=1e-12,B=Math.PI,V=B/2,Wn=B/4,K=B*2,$=180/B,j=B/180,_=Math.abs,nt=Math.atan,on=Math.atan2,U=Math.cos,Tt=Math.exp,Ht=Math.log,X=Math.sin,Ot=Math.sign||function(n){return n>0?1:n<0?-1:0},mn=Math.sqrt,Ft=Math.tan;function Wt(n){return n>1?0:n<-1?B:Math.acos(n)}function ln(n){return n>1?V:n<-1?-V:Math.asin(n)}function en(){}function dn(n,t){n&&qn.hasOwnProperty(n.type)&&qn[n.type](n,t)}var _n={Feature:function(n,t){dn(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,r=i.length;++e<r;)dn(i[e].geometry,t)}},qn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Rn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Rn(i[e],t,0)},Polygon:function(n,t){Gn(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Gn(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,r=i.length;++e<r;)dn(i[e],t)}};function Rn(n,t,i){var e=-1,r=n.length-i,a;for(t.lineStart();++e<r;)a=n[e],t.point(a[0],a[1],a[2]);t.lineEnd()}function Gn(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)Rn(n[i],t,1);t.polygonEnd()}function _t(n,t){n&&_n.hasOwnProperty(n.type)?_n[n.type](n,t):dn(n,t)}function Ln(n){return[on(n[1],n[0]),ln(n[2])]}function k(n){var t=n[0],i=n[1],e=U(i);return[e*U(t),e*X(t),X(i)]}function sn(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function wn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Mn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function pn(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Cn(n){var t=mn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function An(n,t){function i(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(i.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),i}function zn(n,t){return _(n)>B&&(n-=Math.round(n/K)*K),[n,t]}zn.invert=zn;function tt(n,t,i){return(n%=K)?t||i?An(Xn(n),Yn(t,i)):Xn(n):t||i?Yn(t,i):zn}function Un(n){return function(t,i){return t+=n,_(t)>B&&(t-=Math.round(t/K)*K),[t,i]}}function Xn(n){var t=Un(n);return t.invert=Un(-n),t}function Yn(n,t){var i=U(n),e=X(n),r=U(t),a=X(t);function f(s,g){var v=U(g),o=U(s)*v,l=X(s)*v,u=X(g),p=u*i+o*e;return[on(l*r-p*a,o*i-u*e),ln(p*r+l*a)]}return f.invert=function(s,g){var v=U(g),o=U(s)*v,l=X(s)*v,u=X(g),p=u*r-l*a;return[on(l*r+u*a,o*i+p*e),ln(p*i-o*e)]},f}function qt(n){n=tt(n[0]*j,n[1]*j,n.length>2?n[2]*j:0);function t(i){return i=n(i[0]*j,i[1]*j),i[0]*=$,i[1]*=$,i}return t.invert=function(i){return i=n.invert(i[0]*j,i[1]*j),i[0]*=$,i[1]*=$,i},t}function Gt(n,t,i,e,r,a){if(i){var f=U(t),s=X(t),g=e*i;r==null?(r=t+e*K,a=t-g/2):(r=jn(f,r),a=jn(f,a),(e>0?r<a:r>a)&&(r+=e*K));for(var v,o=r;e>0?o>a:o<a;o-=g)v=Ln([f,-s*U(o),-s*X(o)]),n.point(v[0],v[1])}}function jn(n,t){t=k(t),t[0]-=n,Cn(t);var i=Wt(-t[1]);return((-t[2]<0?-i:i)+K-F)%K}function et(){var n=[],t;return{point:function(i,e,r){t.push([i,e,r])},lineStart:function(){n.push(t=[])},lineEnd:en,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],t=null,i}}}function gn(n,t){return _(n[0]-t[0])<F&&_(n[1]-t[1])<F}function hn(n,t,i,e){this.x=n,this.z=t,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function it(n,t,i,e,r){var a=[],f=[],s,g;if(n.forEach(function(h){if(!((P=h.length-1)<=0)){var P,d=h[0],z=h[P],E;if(gn(d,z)){if(!d[2]&&!z[2]){for(r.lineStart(),s=0;s<P;++s)r.point((d=h[s])[0],d[1]);r.lineEnd();return}z[0]+=2*F}a.push(E=new hn(d,h,null,!0)),f.push(E.o=new hn(d,null,E,!1)),a.push(E=new hn(z,h,null,!1)),f.push(E.o=new hn(z,null,E,!0))}}),!!a.length){for(f.sort(t),Jn(a),Jn(f),s=0,g=f.length;s<g;++s)f[s].e=i=!i;for(var v=a[0],o,l;;){for(var u=v,p=!0;u.v;)if((u=u.n)===v)return;o=u.z,r.lineStart();do{if(u.v=u.o.v=!0,u.e){if(p)for(s=0,g=o.length;s<g;++s)r.point((l=o[s])[0],l[1]);else e(u.x,u.n.x,1,r);u=u.n}else{if(p)for(o=u.p.z,s=o.length-1;s>=0;--s)r.point((l=o[s])[0],l[1]);else e(u.x,u.p.x,-1,r);u=u.p}u=u.o,o=u.z,p=!p}while(!u.v);r.lineEnd()}}}function Jn(n){if(t=n.length){for(var t,i=0,e=n[0],r;++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function Pn(n){return _(n[0])<=B?n[0]:Ot(n[0])*((_(n[0])+B)%K-B)}function Ut(n,t){var i=Pn(t),e=t[1],r=X(e),a=[X(i),-U(i),0],f=0,s=0,g=new Nt;r===1?e=V+F:r===-1&&(e=-V-F);for(var v=0,o=n.length;v<o;++v)if(u=(l=n[v]).length)for(var l,u,p=l[u-1],h=Pn(p),P=p[1]/2+Wn,d=X(P),z=U(P),E=0;E<u;++E,h=S,d=A,z=N,p=L){var L=l[E],S=Pn(L),R=L[1]/2+Wn,A=X(R),N=U(R),I=S-h,C=I>=0?1:-1,H=C*I,M=H>B,J=d*A;if(g.add(on(J*C*X(H),z*N+J*U(H))),f+=M?I+C*K:I,M^h>=i^S>=i){var W=wn(k(p),k(L));Cn(W);var T=wn(a,W);Cn(T);var c=(M^I>=0?-1:1)*ln(T[2]);(e>c||e===c&&(W[0]||W[1]))&&(s+=M^I>=0?1:-1)}}return(f<-F||f<F&&g<-Bt)^s&1}function rt(n,t,i,e){return function(r){var a=t(r),f=et(),s=t(f),g=!1,v,o,l,u={point:p,lineStart:P,lineEnd:d,polygonStart:function(){u.point=z,u.lineStart=E,u.lineEnd=L,o=[],v=[]},polygonEnd:function(){u.point=p,u.lineStart=P,u.lineEnd=d,o=bn(o);var S=Ut(v,e);o.length?(g||(r.polygonStart(),g=!0),it(o,Yt,S,i,r)):S&&(g||(r.polygonStart(),g=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),g&&(r.polygonEnd(),g=!1),o=v=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(S,R){n(S,R)&&r.point(S,R)}function h(S,R){a.point(S,R)}function P(){u.point=h,a.lineStart()}function d(){u.point=p,a.lineEnd()}function z(S,R){l.push([S,R]),s.point(S,R)}function E(){s.lineStart(),l=[]}function L(){z(l[0][0],l[0][1]),s.lineEnd();var S=s.clean(),R=f.result(),A,N=R.length,I,C,H;if(l.pop(),v.push(l),l=null,!!N){if(S&1){if(C=R[0],(I=C.length-1)>0){for(g||(r.polygonStart(),g=!0),r.lineStart(),A=0;A<I;++A)r.point((H=C[A])[0],H[1]);r.lineEnd()}return}N>1&&S&2&&R.push(R.pop().concat(R.shift())),o.push(R.filter(Xt))}}return u}}function Xt(n){return n.length>1}function Yt(n,t){return((n=n.x)[0]<0?n[1]-V-F:V-n[1])-((t=t.x)[0]<0?t[1]-V-F:V-t[1])}const Qn=rt(function(){return!0},jt,Qt,[-B,-V]);function jt(n){var t=NaN,i=NaN,e=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(a,f){var s=a>0?B:-B,g=_(a-t);_(g-B)<F?(n.point(t,i=(i+f)/2>0?V:-V),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),n.point(a,i),r=0):e!==s&&g>=B&&(_(t-e)<F&&(t-=e*F),_(a-s)<F&&(a-=s*F),i=Jt(t,i,a,f),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),r=0),n.point(t=a,i=f),e=s},lineEnd:function(){n.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function Jt(n,t,i,e){var r,a,f=X(n-i);return _(f)>F?nt((X(t)*(a=U(e))*X(i)-X(e)*(r=U(t))*X(n))/(r*a*f)):(t+e)/2}function Qt(n,t,i,e){var r;if(n==null)r=i*V,e.point(-B,r),e.point(0,r),e.point(B,r),e.point(B,0),e.point(B,-r),e.point(0,-r),e.point(-B,-r),e.point(-B,0),e.point(-B,r);else if(_(n[0]-t[0])>F){var a=n[0]<t[0]?B:-B;r=i*a/2,e.point(-a,r),e.point(0,r),e.point(a,r)}else e.point(t[0],t[1])}function Vt(n){var t=U(n),i=2*j,e=t>0,r=_(t)>F;function a(o,l,u,p){Gt(p,n,i,u,o,l)}function f(o,l){return U(o)*U(l)>t}function s(o){var l,u,p,h,P;return{lineStart:function(){h=p=!1,P=1},point:function(d,z){var E=[d,z],L,S=f(d,z),R=e?S?0:v(d,z):S?v(d+(d<0?B:-B),z):0;if(!l&&(h=p=S)&&o.lineStart(),S!==p&&(L=g(l,E),(!L||gn(l,L)||gn(E,L))&&(E[2]=1)),S!==p)P=0,S?(o.lineStart(),L=g(E,l),o.point(L[0],L[1])):(L=g(l,E),o.point(L[0],L[1],2),o.lineEnd()),l=L;else if(r&&l&&e^S){var A;!(R&u)&&(A=g(E,l,!0))&&(P=0,e?(o.lineStart(),o.point(A[0][0],A[0][1]),o.point(A[1][0],A[1][1]),o.lineEnd()):(o.point(A[1][0],A[1][1]),o.lineEnd(),o.lineStart(),o.point(A[0][0],A[0][1],3)))}S&&(!l||!gn(l,E))&&o.point(E[0],E[1]),l=E,p=S,u=R},lineEnd:function(){p&&o.lineEnd(),l=null},clean:function(){return P|(h&&p)<<1}}}function g(o,l,u){var p=k(o),h=k(l),P=[1,0,0],d=wn(p,h),z=sn(d,d),E=d[0],L=z-E*E;if(!L)return!u&&o;var S=t*z/L,R=-t*E/L,A=wn(P,d),N=pn(P,S),I=pn(d,R);Mn(N,I);var C=A,H=sn(N,C),M=sn(C,C),J=H*H-M*(sn(N,N)-1);if(!(J<0)){var W=mn(J),T=pn(C,(-H-W)/M);if(Mn(T,N),T=Ln(T),!u)return T;var c=o[0],w=l[0],D=o[1],y=l[1],m;w<c&&(m=c,c=w,w=m);var O=w-c,x=_(O-B)<F,q=x||O<F;if(!x&&y<D&&(m=D,D=y,y=m),q?x?D+y>0^T[1]<(_(T[0]-c)<F?D:y):D<=T[1]&&T[1]<=y:O>B^(c<=T[0]&&T[0]<=w)){var G=pn(C,(-H+W)/M);return Mn(G,N),[T,Ln(G)]}}}function v(o,l){var u=e?n:B-n,p=0;return o<-u?p|=1:o>u&&(p|=2),l<-u?p|=4:l>u&&(p|=8),p}return rt(f,s,a,e?[0,-n]:[-B,n-B])}function $t(n,t,i,e,r,a){var f=n[0],s=n[1],g=t[0],v=t[1],o=0,l=1,u=g-f,p=v-s,h;if(h=i-f,!(!u&&h>0)){if(h/=u,u<0){if(h<o)return;h<l&&(l=h)}else if(u>0){if(h>l)return;h>o&&(o=h)}if(h=r-f,!(!u&&h<0)){if(h/=u,u<0){if(h>l)return;h>o&&(o=h)}else if(u>0){if(h<o)return;h<l&&(l=h)}if(h=e-s,!(!p&&h>0)){if(h/=p,p<0){if(h<o)return;h<l&&(l=h)}else if(p>0){if(h>l)return;h>o&&(o=h)}if(h=a-s,!(!p&&h<0)){if(h/=p,p<0){if(h>l)return;h>o&&(o=h)}else if(p>0){if(h<o)return;h<l&&(l=h)}return o>0&&(n[0]=f+o*u,n[1]=s+o*p),l<1&&(t[0]=f+l*u,t[1]=s+l*p),!0}}}}}var rn=1e9,vn=-rn;function Kt(n,t,i,e){function r(v,o){return n<=v&&v<=i&&t<=o&&o<=e}function a(v,o,l,u){var p=0,h=0;if(v==null||(p=f(v,l))!==(h=f(o,l))||g(v,o)<0^l>0)do u.point(p===0||p===3?n:i,p>1?e:t);while((p=(p+l+4)%4)!==h);else u.point(o[0],o[1])}function f(v,o){return _(v[0]-n)<F?o>0?0:3:_(v[0]-i)<F?o>0?2:1:_(v[1]-t)<F?o>0?1:0:o>0?3:2}function s(v,o){return g(v.x,o.x)}function g(v,o){var l=f(v,1),u=f(o,1);return l!==u?l-u:l===0?o[1]-v[1]:l===1?v[0]-o[0]:l===2?v[1]-o[1]:o[0]-v[0]}return function(v){var o=v,l=et(),u,p,h,P,d,z,E,L,S,R,A,N={point:I,lineStart:J,lineEnd:W,polygonStart:H,polygonEnd:M};function I(c,w){r(c,w)&&o.point(c,w)}function C(){for(var c=0,w=0,D=p.length;w<D;++w)for(var y=p[w],m=1,O=y.length,x=y[0],q,G,Q=x[0],Y=x[1];m<O;++m)q=Q,G=Y,x=y[m],Q=x[0],Y=x[1],G<=e?Y>e&&(Q-q)*(e-G)>(Y-G)*(n-q)&&++c:Y<=e&&(Q-q)*(e-G)<(Y-G)*(n-q)&&--c;return c}function H(){o=l,u=[],p=[],A=!0}function M(){var c=C(),w=A&&c,D=(u=bn(u)).length;(w||D)&&(v.polygonStart(),w&&(v.lineStart(),a(null,null,1,v),v.lineEnd()),D&&it(u,s,c,a,v),v.polygonEnd()),o=v,u=p=h=null}function J(){N.point=T,p&&p.push(h=[]),R=!0,S=!1,E=L=NaN}function W(){u&&(T(P,d),z&&S&&l.rejoin(),u.push(l.result())),N.point=I,S&&o.lineEnd()}function T(c,w){var D=r(c,w);if(p&&h.push([c,w]),R)P=c,d=w,z=D,R=!1,D&&(o.lineStart(),o.point(c,w));else if(D&&S)o.point(c,w);else{var y=[E=Math.max(vn,Math.min(rn,E)),L=Math.max(vn,Math.min(rn,L))],m=[c=Math.max(vn,Math.min(rn,c)),w=Math.max(vn,Math.min(rn,w))];$t(y,m,n,t,i,e)?(S||(o.lineStart(),o.point(y[0],y[1])),o.point(m[0],m[1]),D||o.lineEnd(),A=!1):D&&(o.lineStart(),o.point(c,w),A=!1)}E=c,L=w,S=D}return N}}const Vn=n=>n;var b=1/0,Sn=b,un=-b,En=un,$n={point:Zt,lineStart:en,lineEnd:en,polygonStart:en,polygonEnd:en,result:function(){var n=[[b,Sn],[un,En]];return un=En=-(Sn=b=1/0),n}};function Zt(n,t){n<b&&(b=n),n>un&&(un=n),t<Sn&&(Sn=t),t>En&&(En=t)}function xn(n){return function(t){var i=new Dn;for(var e in n)i[e]=n[e];return i.stream=t,i}}function Dn(){}Dn.prototype={constructor:Dn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Nn(n,t,i){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),_t(i,n.stream($n)),t($n.result()),e!=null&&n.clipExtent(e),n}function ot(n,t,i){return Nn(n,function(e){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],f=Math.min(r/(e[1][0]-e[0][0]),a/(e[1][1]-e[0][1])),s=+t[0][0]+(r-f*(e[1][0]+e[0][0]))/2,g=+t[0][1]+(a-f*(e[1][1]+e[0][1]))/2;n.scale(150*f).translate([s,g])},i)}function kt(n,t,i){return ot(n,[[0,0],t],i)}function bt(n,t,i){return Nn(n,function(e){var r=+t,a=r/(e[1][0]-e[0][0]),f=(r-a*(e[1][0]+e[0][0]))/2,s=-a*e[0][1];n.scale(150*a).translate([f,s])},i)}function ne(n,t,i){return Nn(n,function(e){var r=+t,a=r/(e[1][1]-e[0][1]),f=-a*e[0][0],s=(r-a*(e[1][1]+e[0][1]))/2;n.scale(150*a).translate([f,s])},i)}var Kn=16,te=U(30*j);function Zn(n,t){return+t?ie(n,t):ee(n)}function ee(n){return xn({point:function(t,i){t=n(t,i),this.stream.point(t[0],t[1])}})}function ie(n,t){function i(e,r,a,f,s,g,v,o,l,u,p,h,P,d){var z=v-e,E=o-r,L=z*z+E*E;if(L>4*t&&P--){var S=f+u,R=s+p,A=g+h,N=mn(S*S+R*R+A*A),I=ln(A/=N),C=_(_(A)-1)<F||_(a-l)<F?(a+l)/2:on(R,S),H=n(C,I),M=H[0],J=H[1],W=M-e,T=J-r,c=E*W-z*T;(c*c/L>t||_((z*W+E*T)/L-.5)>.3||f*u+s*p+g*h<te)&&(i(e,r,a,f,s,g,M,J,C,S/=N,R/=N,A,P,d),d.point(M,J),i(M,J,C,S,R,A,v,o,l,u,p,h,P,d))}}return function(e){var r,a,f,s,g,v,o,l,u,p,h,P,d={point:z,lineStart:E,lineEnd:S,polygonStart:function(){e.polygonStart(),d.lineStart=R},polygonEnd:function(){e.polygonEnd(),d.lineStart=E}};function z(I,C){I=n(I,C),e.point(I[0],I[1])}function E(){l=NaN,d.point=L,e.lineStart()}function L(I,C){var H=k([I,C]),M=n(I,C);i(l,u,o,p,h,P,l=M[0],u=M[1],o=I,p=H[0],h=H[1],P=H[2],Kn,e),e.point(l,u)}function S(){d.point=z,e.lineEnd()}function R(){E(),d.point=A,d.lineEnd=N}function A(I,C){L(r=I,C),a=l,f=u,s=p,g=h,v=P,d.point=L}function N(){i(l,u,o,p,h,P,a,f,r,s,g,v,Kn,e),d.lineEnd=S,S()}return d}}var re=xn({point:function(n,t){this.stream.point(n*j,t*j)}});function oe(n){return xn({point:function(t,i){var e=n(t,i);return this.stream.point(e[0],e[1])}})}function le(n,t,i,e,r){function a(f,s){return f*=e,s*=r,[t+n*f,i-n*s]}return a.invert=function(f,s){return[(f-t)/n*e,(i-s)/n*r]},a}function kn(n,t,i,e,r,a){if(!a)return le(n,t,i,e,r);var f=U(a),s=X(a),g=f*n,v=s*n,o=f/n,l=s/n,u=(s*i-f*t)/n,p=(s*t+f*i)/n;function h(P,d){return P*=e,d*=r,[g*P-v*d+t,i-v*P-g*d]}return h.invert=function(P,d){return[e*(o*P-l*d+u),r*(p-l*P-o*d)]},h}function ue(n){return fe(function(){return n})()}function fe(n){var t,i=150,e=480,r=250,a=0,f=0,s=0,g=0,v=0,o,l=0,u=1,p=1,h=null,P=Qn,d=null,z,E,L,S=Vn,R=.5,A,N,I,C,H;function M(c){return I(c[0]*j,c[1]*j)}function J(c){return c=I.invert(c[0],c[1]),c&&[c[0]*$,c[1]*$]}M.stream=function(c){return C&&H===c?C:C=re(oe(o)(P(A(S(H=c)))))},M.preclip=function(c){return arguments.length?(P=c,h=void 0,T()):P},M.postclip=function(c){return arguments.length?(S=c,d=z=E=L=null,T()):S},M.clipAngle=function(c){return arguments.length?(P=+c?Vt(h=c*j):(h=null,Qn),T()):h*$},M.clipExtent=function(c){return arguments.length?(S=c==null?(d=z=E=L=null,Vn):Kt(d=+c[0][0],z=+c[0][1],E=+c[1][0],L=+c[1][1]),T()):d==null?null:[[d,z],[E,L]]},M.scale=function(c){return arguments.length?(i=+c,W()):i},M.translate=function(c){return arguments.length?(e=+c[0],r=+c[1],W()):[e,r]},M.center=function(c){return arguments.length?(a=c[0]%360*j,f=c[1]%360*j,W()):[a*$,f*$]},M.rotate=function(c){return arguments.length?(s=c[0]%360*j,g=c[1]%360*j,v=c.length>2?c[2]%360*j:0,W()):[s*$,g*$,v*$]},M.angle=function(c){return arguments.length?(l=c%360*j,W()):l*$},M.reflectX=function(c){return arguments.length?(u=c?-1:1,W()):u<0},M.reflectY=function(c){return arguments.length?(p=c?-1:1,W()):p<0},M.precision=function(c){return arguments.length?(A=Zn(N,R=c*c),T()):mn(R)},M.fitExtent=function(c,w){return ot(M,c,w)},M.fitSize=function(c,w){return kt(M,c,w)},M.fitWidth=function(c,w){return bt(M,c,w)},M.fitHeight=function(c,w){return ne(M,c,w)};function W(){var c=kn(i,0,0,u,p,l).apply(null,t(a,f)),w=kn(i,e-c[0],r-c[1],u,p,l);return o=tt(s,g,v),N=An(t,w),I=An(o,N),A=Zn(N,R),T()}function T(){return C=H=null,M}return function(){return t=n.apply(this,arguments),M.invert=t.invert&&J,W()}}function In(n,t){return[n,Ht(Ft((V+t)/2))]}In.invert=function(n,t){return[n,2*nt(Tt(t))-V]};function ae(){return ce(In).scale(961/K)}function ce(n){var t=ue(n),i=t.center,e=t.scale,r=t.translate,a=t.clipExtent,f=null,s,g,v;t.scale=function(l){return arguments.length?(e(l),o()):e()},t.translate=function(l){return arguments.length?(r(l),o()):r()},t.center=function(l){return arguments.length?(i(l),o()):i()},t.clipExtent=function(l){return arguments.length?(l==null?f=s=g=v=null:(f=+l[0][0],s=+l[0][1],g=+l[1][0],v=+l[1][1]),o()):f==null?null:[[f,s],[g,v]]};function o(){var l=B*e(),u=t(qt(t.rotate()).invert([0,0]));return a(f==null?[[u[0]-l,u[1]-l],[u[0]+l,u[1]+l]]:n===In?[[Math.max(u[0]-l,f),s],[Math.min(u[0]+l,g),v]]:[[f,Math.max(u[1]-l,s)],[g,Math.min(u[1]+l,v)]])}return o()}const de={__name:"Map",setup(n){let t=Ct(),i=new at,e=new ct(90,window.innerWidth/window.innerHeight,.1,1e5);e.position.set(0,0,100),e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),i.add(e);let r=new st(16777215,1);i.add(r);const a=new pt(16777215,.5);i.add(a);let f=new ht({antialias:!0});f.setSize(window.innerWidth,window.innerHeight);let s=new Bn,g=ae().center([116.402,39.915]).translate([0,0,0]),v=new vt,o=new URL("/assets/map-BqTUXMPq.json",import.meta.url).href;v.load(o,w=>{let D=JSON.parse(w);u(D)});let l=[],u=w=>{w.features.forEach(y=>{let m=new Bn;m.name=y.properties.name;let O=y.properties.centroid||y.properties.center,x=P(O,y.properties.name);O&&l.push(O),x&&m.add(x);let q=y.geometry.coordinates,G="#99ff99";y.geometry.type==="MultiPolygon"&&q.forEach(Q=>{Q.forEach(Y=>{let Z=p(Y,G,g),fn=h(Y,G,g);fn.properties=y.properties.name,m.add(Z),m.add(fn)})}),y.geometry.type==="Polygon"&&q.forEach(Q=>{let Y=p(Q,G,g),Z=h(Q,G,g);Z.properties=y.properties.name,m.add(Y),m.add(Z)}),s.add(m)}),i.add(s),L(l)},p=(w,D,y)=>{let m=new Tn,O=new Array;w.forEach(G=>{let[Q,Y]=y(G);O.push(new tn(Q,-Y,3))}),m.setFromPoints(O);let x=new gt(Math.random()*.5+.5,Math.random()*.5+.5,Math.random()*.5+.5),q=new Hn({color:x});return new On(m,q)},h=(w,D,y)=>{let m=new dt;w.forEach((G,Q)=>{let[Y,Z]=y(G);Q===0&&m.moveTo(Y,-Z),m.lineTo(Y,-Z)});let O=new wt(m,{depth:3,bevelEnabled:!1}),x=(Math.random()*.5+.5)*255,q=new St({color:x,transparent:!0,opacity:.5});return new Et(O,q)},P=(w,D)=>{if(w){let[y,m]=g(w),O=new tn(y*1,-m*1,3),x=document.createElement("div");x.style.color="#ffffff",x.style.fontSize="12px",x.style.textShadow="1px 1px 2px #047cd6",x.className="map-label",x.innerHTML=D;let q=new Rt(x);return q.scale.set(.01,.01,.01),q.position.copy(O),q}},d=[],z=8,E=10,L=w=>{let D=w.length,y=w,m=y[0];y.shift();let O=[];for(;O.length<z*2;){let x=Math.floor(Math.random()*D);y[x]&&(O.push(y[x]),O.push(m),y.splice(x,1))}for(let x=0;x<O.length;x+=2){let[q,G]=g([O[x][0],O[x][1]]),Q=new tn(q,-G,5),[Y,Z]=g([O[x+1][0],O[x+1][1]]),fn=new tn(Y,-Z,5),lt=new tn((q+Y)/2,(-G+-Y)/2,15),yn=new mt(Q,lt,fn).getPoints(E),an=new Tn().setFromPoints(yn);an.vertices=yn;let cn=[];for(let nn=0;nn<yn.length*3;nn+=3)cn[nn]=0,cn[nn+1]=1,cn[nn+2]=0;let ut=new Fn(cn,3);an.setAttribute("color",ut),d.push(an);let ft=new On(an,new Hn({vertexColors:!0,transparent:!0,side:yt,opacity:.8,linewidth:30}));i.add(ft)}return d},S=0,R=0,A=()=>{let w=new Date().getTime();w-S>100&&(d.forEach((D,y)=>{if(D){let m=[];for(let x=0;x<E+1;x++)x==R?(m.push(1),m.push(1),m.push(1)):(m.push(0),m.push(1),m.push(0));let O=new Fn(m,3);D.setAttribute("color",O),D.needsUpdate=!0,R++,R>z&&(R=0)}}),S=w)},N=new Lt;N.setSize(window.innerWidth,window.innerHeight),N.domElement.style.position="absolute",N.domElement.style.left="0px",N.domElement.style.top="0px";let I,C=null,H=null,M=w=>{let D=J(w),y=new Mt;y.setFromCamera(D,e);let m=y.intersectObjects([s],!0);m.length>0?(C&&C.object.properties!==m[0].object.properties&&(C.object.material.color.set(H),C=null),m[0].object.properties&&(H=m[0].object.material.color.clone(),m[0].object.material.color.set("red")),C=m[0]):C&&C.object.properties&&(C.object.material.color.set(H),C=null)};window.addEventListener("click",M);let J=w=>{let D={x:0,y:0},y=I.getBoundingClientRect(),m={x:(w.clientX-y.left)*y.width/y.width,y:(w.clientY-y.top)*y.height/y.height};return D.x=m.x/I.width*2-1,D.y=-(m.y/I.height)*2+1,D},W=new Pt(e,N.domElement);W.enableDamping=!0;let T=()=>{W.update(),requestAnimationFrame(T),f.render(i,e),N.render(i,e),A()};T();let c=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),N.setSize(window.innerWidth,window.innerHeight),f.setSize(window.innerWidth,window.innerHeight),f.setPixelRatio(window.devicePixelRatio)};return window.addEventListener("resize",c),At(()=>{t.value.appendChild(f.domElement),t.value.appendChild(N.domElement),I=f.domElement}),zt(()=>{window.removeEventListener("resize",c),window.removeEventListener("click",M)}),(w,D)=>(xt(),Dt("div",{id:"map",class:"mapScene",ref_key:"mapScene",ref:t},null,512))}};export{de as default};
