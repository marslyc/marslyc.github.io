import{p as le,ad as W,c as x,V as L,q as se,Q as pe,W as de,L as me,z as ue,B as he,H as fe,w as ge,U as ye,Y as K,M as J,N as ae,ae as be,D as we,T as ie,af as Ee,a as xe,S as Se,o as je,v as Oe,m as ve,n as _e,l as Me}from"./three.module-DxqIPYNp.js";import{G as Te}from"./GLTFLoader-CeTFqpKO.js";import{_ as Le,r as F,o as Pe,f as ke,c as Ce,b as Y,a as ze}from"./index-CN0LzfL9.js";const $={type:"change"},ee={type:"start"},te={type:"end"};class Ae extends le{constructor(Q,X){super();const e=this,s={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=Q,this.domElement=X,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:W.ROTATE,MIDDLE:W.DOLLY,RIGHT:W.PAN},this.target=new x;const B=1e-6,N=new x;let U=1,g=s.NONE,S=s.NONE,P=0,v=0,k=0;const h=new x,j=new L,f=new L,V=new x,O=new L,C=new L,l=new L,z=new L,c=[],A={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const t=e.domElement.getBoundingClientRect(),o=e.domElement.ownerDocument.documentElement;e.screen.left=t.left+window.pageXOffset-o.clientLeft,e.screen.top=t.top+window.pageYOffset-o.clientTop,e.screen.width=t.width,e.screen.height=t.height};const _=function(){const t=new L;return function(u,E){return t.set((u-e.screen.left)/e.screen.width,(E-e.screen.top)/e.screen.height),t}}(),R=function(){const t=new L;return function(u,E){return t.set((u-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-E))/e.screen.width),t}}();this.rotateCamera=function(){const t=new x,o=new pe,u=new x,E=new x,D=new x,H=new x;return function(){H.set(f.x-j.x,f.y-j.y,0);let G=H.length();G?(h.copy(e.object.position).sub(e.target),u.copy(h).normalize(),E.copy(e.object.up).normalize(),D.crossVectors(E,u).normalize(),E.setLength(f.y-j.y),D.setLength(f.x-j.x),H.copy(E.add(D)),t.crossVectors(H,h).normalize(),G*=e.rotateSpeed,o.setFromAxisAngle(t,G),h.applyQuaternion(o),e.object.up.applyQuaternion(o),V.copy(t),k=G):!e.staticMoving&&k&&(k*=Math.sqrt(1-e.dynamicDampingFactor),h.copy(e.object.position).sub(e.target),o.setFromAxisAngle(V,k),h.applyQuaternion(o),e.object.up.applyQuaternion(o)),j.copy(f)}}(),this.zoomCamera=function(){let t;g===s.TOUCH_ZOOM_PAN?(t=P/v,P=v,e.object.isPerspectiveCamera?h.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=se.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),U!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(t=1+(C.y-O.y)*e.zoomSpeed,t!==1&&t>0&&(e.object.isPerspectiveCamera?h.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=se.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),U!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?O.copy(C):O.y+=(C.y-O.y)*this.dynamicDampingFactor)},this.panCamera=function(){const t=new L,o=new x,u=new x;return function(){if(t.copy(z).sub(l),t.lengthSq()){if(e.object.isOrthographicCamera){const D=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,H=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;t.x*=D,t.y*=H}t.multiplyScalar(h.length()*e.panSpeed),u.copy(h).cross(e.object.up).setLength(t.x),u.add(o.copy(e.object.up).setLength(t.y)),e.object.position.add(u),e.target.add(u),e.staticMoving?l.copy(z):l.add(t.subVectors(z,l).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(h.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,h.setLength(e.maxDistance)),O.copy(C)),h.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,h.setLength(e.minDistance)),O.copy(C)))},this.update=function(){h.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,h),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),N.distanceToSquared(e.object.position)>B&&(e.dispatchEvent($),N.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(N.distanceToSquared(e.object.position)>B||U!==e.object.zoom)&&(e.dispatchEvent($),N.copy(e.object.position),U=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){g=s.NONE,S=s.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),h.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent($),N.copy(e.object.position),U=e.object.zoom};function q(t){e.enabled!==!1&&(c.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",a),e.domElement.addEventListener("pointerup",n)),I(t),t.pointerType==="touch"?M(t):y(t))}function a(t){e.enabled!==!1&&(t.pointerType==="touch"?w(t):d(t))}function n(t){e.enabled!==!1&&(t.pointerType==="touch"?Z(t):b(),oe(t),c.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",a),e.domElement.removeEventListener("pointerup",n)))}function r(t){oe(t)}function i(t){e.enabled!==!1&&(window.removeEventListener("keydown",i),S===s.NONE&&(t.code===e.keys[s.ROTATE]&&!e.noRotate?S=s.ROTATE:t.code===e.keys[s.ZOOM]&&!e.noZoom?S=s.ZOOM:t.code===e.keys[s.PAN]&&!e.noPan&&(S=s.PAN)))}function p(){e.enabled!==!1&&(S=s.NONE,window.addEventListener("keydown",i))}function y(t){if(g===s.NONE)switch(t.button){case e.mouseButtons.LEFT:g=s.ROTATE;break;case e.mouseButtons.MIDDLE:g=s.ZOOM;break;case e.mouseButtons.RIGHT:g=s.PAN;break}const o=S!==s.NONE?S:g;o===s.ROTATE&&!e.noRotate?(f.copy(R(t.pageX,t.pageY)),j.copy(f)):o===s.ZOOM&&!e.noZoom?(O.copy(_(t.pageX,t.pageY)),C.copy(O)):o===s.PAN&&!e.noPan&&(l.copy(_(t.pageX,t.pageY)),z.copy(l)),e.dispatchEvent(ee)}function d(t){const o=S!==s.NONE?S:g;o===s.ROTATE&&!e.noRotate?(j.copy(f),f.copy(R(t.pageX,t.pageY))):o===s.ZOOM&&!e.noZoom?C.copy(_(t.pageX,t.pageY)):o===s.PAN&&!e.noPan&&z.copy(_(t.pageX,t.pageY))}function b(){g=s.NONE,e.dispatchEvent(te)}function m(t){if(e.enabled!==!1&&e.noZoom!==!0){switch(t.preventDefault(),t.deltaMode){case 2:O.y-=t.deltaY*.025;break;case 1:O.y-=t.deltaY*.01;break;default:O.y-=t.deltaY*25e-5;break}e.dispatchEvent(ee),e.dispatchEvent(te)}}function M(t){switch(ne(t),c.length){case 1:g=s.TOUCH_ROTATE,f.copy(R(c[0].pageX,c[0].pageY)),j.copy(f);break;default:g=s.TOUCH_ZOOM_PAN;const o=c[0].pageX-c[1].pageX,u=c[0].pageY-c[1].pageY;v=P=Math.sqrt(o*o+u*u);const E=(c[0].pageX+c[1].pageX)/2,D=(c[0].pageY+c[1].pageY)/2;l.copy(_(E,D)),z.copy(l);break}e.dispatchEvent(ee)}function w(t){switch(ne(t),c.length){case 1:j.copy(f),f.copy(R(t.pageX,t.pageY));break;default:const o=re(t),u=t.pageX-o.x,E=t.pageY-o.y;v=Math.sqrt(u*u+E*E);const D=(t.pageX+o.x)/2,H=(t.pageY+o.y)/2;z.copy(_(D,H));break}}function Z(t){switch(c.length){case 0:g=s.NONE;break;case 1:g=s.TOUCH_ROTATE,f.copy(R(t.pageX,t.pageY)),j.copy(f);break;case 2:g=s.TOUCH_ZOOM_PAN;for(let o=0;o<c.length;o++)if(c[o].pointerId!==t.pointerId){const u=A[c[o].pointerId];f.copy(R(u.x,u.y)),j.copy(f);break}break}e.dispatchEvent(te)}function T(t){e.enabled!==!1&&t.preventDefault()}function I(t){c.push(t)}function oe(t){delete A[t.pointerId];for(let o=0;o<c.length;o++)if(c[o].pointerId==t.pointerId){c.splice(o,1);return}}function ne(t){let o=A[t.pointerId];o===void 0&&(o=new L,A[t.pointerId]=o),o.set(t.pageX,t.pageY)}function re(t){const o=t.pointerId===c[0].pointerId?c[1]:c[0];return A[o.pointerId]}this.dispose=function(){e.domElement.removeEventListener("contextmenu",T),e.domElement.removeEventListener("pointerdown",q),e.domElement.removeEventListener("pointercancel",r),e.domElement.removeEventListener("wheel",m),e.domElement.removeEventListener("pointermove",a),e.domElement.removeEventListener("pointerup",n),window.removeEventListener("keydown",i),window.removeEventListener("keyup",p)},this.domElement.addEventListener("contextmenu",T),this.domElement.addEventListener("pointerdown",q),this.domElement.addEventListener("pointercancel",r),this.domElement.addEventListener("wheel",m,{passive:!1}),window.addEventListener("keydown",i),window.addEventListener("keyup",p),this.handleResize(),this.update()}}const De={id:"bone",ref:"",class:"boxx"},Ne={class:"box-main"},Re={__name:"MluScene",setup(ce){let Q=F(null),X=F(null),e=F(null),s=F(null),B=F(null),N=F(null),U=F(null),g=0,S=()=>{let P=document.querySelector(".boxx");g=P.scrollHeight-P.clientHeight};return Pe(()=>{let P=[],v=(a,n)=>{P.push({elem:a,fn:n})},k=a=>{let n=new Se,r=new je(45,2,.1,5);r.position.set(0,1,2),r.lookAt(0,0,0),n.add(r);let i=new Ae(r,a);i.noZoom=!0,i.noPan=!0;let p=new Oe(.5);n.add(p);const y=16777215,d=1;let b=new ve(y,d);n.add(b);const m=new _e(y,d);return m.position.set(-1,2,4),r.add(m),{scene:n,camera:r,elem:a,controls:i}},h=()=>{let{scene:a,camera:n,elem:r,controls:i}=k(X.value);const p=new me({linewidth:2,vertexColors:!0});let d=new ue(new x(.5,.5,0),new x(-.5,-1,0),new x(1,-.5,0)).getPoints(3),b=[];d.forEach(T=>{b.push(T.x,T.y,T.z)});const m=new he().setFromPoints(d);let M=[1,0,0,0,1,0,0,0,1,1,1,0],w=new fe(M,3);m.setAttribute("color",w);const Z=new ge(m,p);a.add(Z),v(r,(T,I)=>{n.aspect=I.width/I.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),l.render(a,n)})},j=()=>{let{scene:a,camera:n,elem:r,controls:i}=k(e.value);const p=new ye(.5,.5,.5),y=new K({color:"red"}),d=new J(p,y);a.add(d),v(r,(b,m)=>{n.aspect=m.width/m.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),d.rotation.y+=.01,l.render(a,n)})},f=()=>{let{scene:a,camera:n,elem:r,controls:i}=k(s.value);const p=new ae(.5,7,4,.8,Math.PI),y=new be({wireframe:!0,color:255,side:we}),d=new J(p,y);d.position.set(0,0,0),a.add(d),v(r,(b,m)=>{n.aspect=m.width/m.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),l.render(a,n)})},V=()=>{let{scene:a,camera:n,elem:r,controls:i}=k(B.value),p=new URL("/assets/earth_atmos_2048-d1pdJ3jg.jpg",import.meta.url).href,y=new URL("/assets/earth_specular_2048-6aAFN27D.jpg",import.meta.url).href,d=new URL("/assets/earth_normal_2048-BD2vMuPH.jpg",import.meta.url).href,b=new ie;const m=new ae(.5,32,32),M=new K({specular:3355443,shininess:5,map:b.load(p),specularMap:b.load(y),normalMap:b.load(d),normalScale:new L(.85,.85)});let w=new J(m,M);a.add(w),v(r,(Z,T)=>{n.aspect=T.width/T.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),w.rotation.y+=.01,l.render(a,n)})},O=()=>{let{scene:a,camera:n,elem:r,controls:i}=k(N.value);n.position.set(2,1,0);const p=new ie;let y=new URL("/assets/050-0KLaPgHm.jpg",import.meta.url).href;const d=p.load(y);d.mapping=Ee,a.background=d,a.environment=d;const b=new Te;let m=new URL("/assets/lion-C8oH2N95.gltf",import.meta.url).href;b.load(m,M=>{const w=M.scene.children[0];w.material=new K({color:16777215,envMap:d,refractionRatio:.7,reflectivity:.99}),a.add(w)}),v(r,(M,w)=>{n.aspect=w.width/w.height,n.updateProjectionMatrix(),i.handleResize(),i.update(),l.render(a,n)})};const C=document.querySelector("#c");let l=new de({antialias:!0,canvas:C,alpha:!0}),z=a=>{const n=a.domElement,r=n.clientWidth,i=n.clientHeight,p=n.width!==r||n.height!==i;return p&&a.setSize(r,i,!1),p},c=new Me;h(),j(),f(),V(),O();let A=document.querySelector(".boxx");g=A.scrollHeight-A.clientHeight,window.addEventListener("resize",S);let _=0,R=a=>{if(_=a.target.scrollTop,_<g){let r=document.querySelector(".box-main").clientHeight;const i=`translateY(${_}px)`;let p=document.querySelector("#c");p.style.position="absolute",p.style.transform=i,p.style.height=r-_+"px"}};A.addEventListener("scroll",R);let q=()=>{let a=c.getDelta();z(l);let n=new xe(16777215);l.setScissorTest(!1),l.setClearColor(n,0),l.clear(!0,!0),l.setScissorTest(!0);for(let{elem:r,fn:i}of P){const p=r.getBoundingClientRect(),{left:y,right:d,top:b,bottom:m,width:M,height:w}=p;let Z=y-180;if(!(m<0||b>l.domElement.clientHeight||d<0||Z>l.domElement.clientWidth)){const I=l.domElement.clientHeight-m;l.setScissor(Z,I,M,w),l.setViewport(Z,I,M,w),i(a,p)}}requestAnimationFrame(q)};q()}),ke(()=>{window.removeEventListener("resize",S)}),(P,v)=>(ze(),Ce("div",De,[Y("div",Ne,[Y("canvas",{id:"c",class:"box-c",ref_key:"canvasScene",ref:Q},null,512),Y("div",{ref_key:"colorScene",ref:X,class:"box-color"},"顶点颜色渲染",512),Y("div",{ref_key:"carScene",ref:e,class:"box-car"},"网格模型",512),Y("div",{ref_key:"sphereScene",ref:s,class:"box-bone"},"球缓冲体",512),Y("div",{ref_key:"b1Scene",ref:B,class:"box-bone"},"纹理贴图",512),Y("div",{ref_key:"b2Scene",ref:N,class:"box-bone"},"模型加载",512),Y("div",{ref_key:"b3Scene",ref:U,class:"box-bone"},"自定义",512)])],512))}},Ie=Le(Re,[["__scopeId","data-v-28ca528b"]]);export{Ie as default};
