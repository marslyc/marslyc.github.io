import{S as ct,r as st,v as pt,q as ht,p as vt,W as gt,O as Hn,F as dt,B as Tn,c as en,a as wt,L as On,w as Fn,x as St,y as Et,k as mt,M as yt,z as Mt,H as Wn,D as Pt,R as Rt}from"./three.module-B9tCJV9l.js";import{O as Lt}from"./OrbitControls-tDbgpgFB.js";import{C as At,a as Ct}from"./CSS2DRenderer-Cjblm300.js";import{r as xt,o as zt,f as Dt,c as Nt,a as It}from"./index-ClFDabME.js";class Bt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const f=i[r],c=t+f,s=Math.abs(t)<Math.abs(f)?t-(c-f):f-(c-t);s&&(i[e++]=s),t=c}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,r,f,c=0;if(i>0){for(c=t[--i];i>0&&(e=c,r=t[--i],c=e+r,f=r-(c-e),!f););i>0&&(f<0&&t[i-1]<0||f>0&&t[i-1]>0)&&(r=f*2,e=c+r,r==e-c&&(c=e))}return c}}function*Ht(n){for(const t of n)yield*t}function nt(n){return Array.from(Ht(n))}var W=1e-6,Tt=1e-12,H=Math.PI,V=H/2,_n=H/4,Z=H*2,K=180/H,Y=H/180,G=Math.abs,tt=Math.atan,ln=Math.atan2,U=Math.cos,Ot=Math.exp,Ft=Math.log,X=Math.sin,Wt=Math.sign||function(n){return n>0?1:n<0?-1:0},yn=Math.sqrt,_t=Math.tan;function qt(n){return n>1?0:n<-1?H:Math.acos(n)}function un(n){return n>1?V:n<-1?-V:Math.asin(n)}function rn(){}function wn(n,t){n&&Gn.hasOwnProperty(n.type)&&Gn[n.type](n,t)}var qn={Feature:function(n,t){wn(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,r=i.length;++e<r;)wn(i[e].geometry,t)}},Gn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Ln(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Ln(i[e],t,0)},Polygon:function(n,t){Un(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Un(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,r=i.length;++e<r;)wn(i[e],t)}};function Ln(n,t,i){var e=-1,r=n.length-i,f;for(t.lineStart();++e<r;)f=n[e],t.point(f[0],f[1],f[2]);t.lineEnd()}function Un(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)Ln(n[i],t,1);t.polygonEnd()}function Gt(n,t){n&&qn.hasOwnProperty(n.type)?qn[n.type](n,t):wn(n,t)}function An(n){return[ln(n[1],n[0]),un(n[2])]}function b(n){var t=n[0],i=n[1],e=U(i);return[e*U(t),e*X(t),X(i)]}function pn(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Sn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Pn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function hn(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Cn(n){var t=yn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function xn(n,t){function i(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(i.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),i}function zn(n,t){return G(n)>H&&(n-=Math.round(n/Z)*Z),[n,t]}zn.invert=zn;function et(n,t,i){return(n%=Z)?t||i?xn(Yn(n),jn(t,i)):Yn(n):t||i?jn(t,i):zn}function Xn(n){return function(t,i){return t+=n,G(t)>H&&(t-=Math.round(t/Z)*Z),[t,i]}}function Yn(n){var t=Xn(n);return t.invert=Xn(-n),t}function jn(n,t){var i=U(n),e=X(n),r=U(t),f=X(t);function c(s,g){var h=U(g),o=U(s)*h,l=X(s)*h,u=X(g),v=u*i+o*e;return[ln(l*r-v*f,o*i-u*e),un(v*r+l*f)]}return c.invert=function(s,g){var h=U(g),o=U(s)*h,l=X(s)*h,u=X(g),v=u*r-l*f;return[ln(l*r+u*f,o*i+v*e),un(v*i-o*e)]},c}function Ut(n){n=et(n[0]*Y,n[1]*Y,n.length>2?n[2]*Y:0);function t(i){return i=n(i[0]*Y,i[1]*Y),i[0]*=K,i[1]*=K,i}return t.invert=function(i){return i=n.invert(i[0]*Y,i[1]*Y),i[0]*=K,i[1]*=K,i},t}function Xt(n,t,i,e,r,f){if(i){var c=U(t),s=X(t),g=e*i;r==null?(r=t+e*Z,f=t-g/2):(r=Jn(c,r),f=Jn(c,f),(e>0?r<f:r>f)&&(r+=e*Z));for(var h,o=r;e>0?o>f:o<f;o-=g)h=An([c,-s*U(o),-s*X(o)]),n.point(h[0],h[1])}}function Jn(n,t){t=b(t),t[0]-=n,Cn(t);var i=qt(-t[1]);return((-t[2]<0?-i:i)+Z-W)%Z}function it(){var n=[],t;return{point:function(i,e,r){t.push([i,e,r])},lineStart:function(){n.push(t=[])},lineEnd:rn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],t=null,i}}}function dn(n,t){return G(n[0]-t[0])<W&&G(n[1]-t[1])<W}function vn(n,t,i,e){this.x=n,this.z=t,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function rt(n,t,i,e,r){var f=[],c=[],s,g;if(n.forEach(function(p){if(!((y=p.length-1)<=0)){var y,d=p[0],x=p[y],S;if(dn(d,x)){if(!d[2]&&!x[2]){for(r.lineStart(),s=0;s<y;++s)r.point((d=p[s])[0],d[1]);r.lineEnd();return}x[0]+=2*W}f.push(S=new vn(d,p,null,!0)),c.push(S.o=new vn(d,null,S,!1)),f.push(S=new vn(x,p,null,!1)),c.push(S.o=new vn(x,null,S,!0))}}),!!f.length){for(c.sort(t),Qn(f),Qn(c),s=0,g=c.length;s<g;++s)c[s].e=i=!i;for(var h=f[0],o,l;;){for(var u=h,v=!0;u.v;)if((u=u.n)===h)return;o=u.z,r.lineStart();do{if(u.v=u.o.v=!0,u.e){if(v)for(s=0,g=o.length;s<g;++s)r.point((l=o[s])[0],l[1]);else e(u.x,u.n.x,1,r);u=u.n}else{if(v)for(o=u.p.z,s=o.length-1;s>=0;--s)r.point((l=o[s])[0],l[1]);else e(u.x,u.p.x,-1,r);u=u.p}u=u.o,o=u.z,v=!v}while(!u.v);r.lineEnd()}}}function Qn(n){if(t=n.length){for(var t,i=0,e=n[0],r;++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function Rn(n){return G(n[0])<=H?n[0]:Wt(n[0])*((G(n[0])+H)%Z-H)}function Yt(n,t){var i=Rn(t),e=t[1],r=X(e),f=[X(i),-U(i),0],c=0,s=0,g=new Bt;r===1?e=V+W:r===-1&&(e=-V-W);for(var h=0,o=n.length;h<o;++h)if(u=(l=n[h]).length)for(var l,u,v=l[u-1],p=Rn(v),y=v[1]/2+_n,d=X(y),x=U(y),S=0;S<u;++S,p=w,d=P,x=F,v=M){var M=l[S],w=Rn(M),L=M[1]/2+_n,P=X(L),F=U(L),C=w-p,D=C>=0?1:-1,I=D*C,E=I>H,j=d*P;if(g.add(ln(j*D*X(I),x*F+j*U(I))),c+=E?C+D*Z:C,E^p>=i^w>=i){var _=Sn(b(v),b(M));Cn(_);var O=Sn(f,_);Cn(O);var a=(E^C>=0?-1:1)*un(O[2]);(e>a||e===a&&(_[0]||_[1]))&&(s+=E^C>=0?1:-1)}}return(c<-W||c<W&&g<-Tt)^s&1}function ot(n,t,i,e){return function(r){var f=t(r),c=it(),s=t(c),g=!1,h,o,l,u={point:v,lineStart:y,lineEnd:d,polygonStart:function(){u.point=x,u.lineStart=S,u.lineEnd=M,o=[],h=[]},polygonEnd:function(){u.point=v,u.lineStart=y,u.lineEnd=d,o=nt(o);var w=Yt(h,e);o.length?(g||(r.polygonStart(),g=!0),rt(o,Jt,w,i,r)):w&&(g||(r.polygonStart(),g=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),g&&(r.polygonEnd(),g=!1),o=h=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function v(w,L){n(w,L)&&r.point(w,L)}function p(w,L){f.point(w,L)}function y(){u.point=p,f.lineStart()}function d(){u.point=v,f.lineEnd()}function x(w,L){l.push([w,L]),s.point(w,L)}function S(){s.lineStart(),l=[]}function M(){x(l[0][0],l[0][1]),s.lineEnd();var w=s.clean(),L=c.result(),P,F=L.length,C,D,I;if(l.pop(),h.push(l),l=null,!!F){if(w&1){if(D=L[0],(C=D.length-1)>0){for(g||(r.polygonStart(),g=!0),r.lineStart(),P=0;P<C;++P)r.point((I=D[P])[0],I[1]);r.lineEnd()}return}F>1&&w&2&&L.push(L.pop().concat(L.shift())),o.push(L.filter(jt))}}return u}}function jt(n){return n.length>1}function Jt(n,t){return((n=n.x)[0]<0?n[1]-V-W:V-n[1])-((t=t.x)[0]<0?t[1]-V-W:V-t[1])}const Vn=ot(function(){return!0},Qt,$t,[-H,-V]);function Qt(n){var t=NaN,i=NaN,e=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(f,c){var s=f>0?H:-H,g=G(f-t);G(g-H)<W?(n.point(t,i=(i+c)/2>0?V:-V),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),n.point(f,i),r=0):e!==s&&g>=H&&(G(t-e)<W&&(t-=e*W),G(f-s)<W&&(f-=s*W),i=Vt(t,i,f,c),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(s,i),r=0),n.point(t=f,i=c),e=s},lineEnd:function(){n.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function Vt(n,t,i,e){var r,f,c=X(n-i);return G(c)>W?tt((X(t)*(f=U(e))*X(i)-X(e)*(r=U(t))*X(n))/(r*f*c)):(t+e)/2}function $t(n,t,i,e){var r;if(n==null)r=i*V,e.point(-H,r),e.point(0,r),e.point(H,r),e.point(H,0),e.point(H,-r),e.point(0,-r),e.point(-H,-r),e.point(-H,0),e.point(-H,r);else if(G(n[0]-t[0])>W){var f=n[0]<t[0]?H:-H;r=i*f/2,e.point(-f,r),e.point(0,r),e.point(f,r)}else e.point(t[0],t[1])}function Kt(n){var t=U(n),i=2*Y,e=t>0,r=G(t)>W;function f(o,l,u,v){Xt(v,n,i,u,o,l)}function c(o,l){return U(o)*U(l)>t}function s(o){var l,u,v,p,y;return{lineStart:function(){p=v=!1,y=1},point:function(d,x){var S=[d,x],M,w=c(d,x),L=e?w?0:h(d,x):w?h(d+(d<0?H:-H),x):0;if(!l&&(p=v=w)&&o.lineStart(),w!==v&&(M=g(l,S),(!M||dn(l,M)||dn(S,M))&&(S[2]=1)),w!==v)y=0,w?(o.lineStart(),M=g(S,l),o.point(M[0],M[1])):(M=g(l,S),o.point(M[0],M[1],2),o.lineEnd()),l=M;else if(r&&l&&e^w){var P;!(L&u)&&(P=g(S,l,!0))&&(y=0,e?(o.lineStart(),o.point(P[0][0],P[0][1]),o.point(P[1][0],P[1][1]),o.lineEnd()):(o.point(P[1][0],P[1][1]),o.lineEnd(),o.lineStart(),o.point(P[0][0],P[0][1],3)))}w&&(!l||!dn(l,S))&&o.point(S[0],S[1]),l=S,v=w,u=L},lineEnd:function(){v&&o.lineEnd(),l=null},clean:function(){return y|(p&&v)<<1}}}function g(o,l,u){var v=b(o),p=b(l),y=[1,0,0],d=Sn(v,p),x=pn(d,d),S=d[0],M=x-S*S;if(!M)return!u&&o;var w=t*x/M,L=-t*S/M,P=Sn(y,d),F=hn(y,w),C=hn(d,L);Pn(F,C);var D=P,I=pn(F,D),E=pn(D,D),j=I*I-E*(pn(F,F)-1);if(!(j<0)){var _=yn(j),O=hn(D,(-I-_)/E);if(Pn(O,F),O=An(O),!u)return O;var a=o[0],z=l[0],A=o[1],B=l[1],m;z<a&&(m=a,a=z,z=m);var R=z-a,T=G(R-H)<W,N=T||R<W;if(!T&&B<A&&(m=A,A=B,B=m),N?T?A+B>0^O[1]<(G(O[0]-a)<W?A:B):A<=O[1]&&O[1]<=B:R>H^(a<=O[0]&&O[0]<=z)){var q=hn(D,(-I+_)/E);return Pn(q,F),[O,An(q)]}}}function h(o,l){var u=e?n:H-n,v=0;return o<-u?v|=1:o>u&&(v|=2),l<-u?v|=4:l>u&&(v|=8),v}return ot(c,s,f,e?[0,-n]:[-H,n-H])}function Zt(n,t,i,e,r,f){var c=n[0],s=n[1],g=t[0],h=t[1],o=0,l=1,u=g-c,v=h-s,p;if(p=i-c,!(!u&&p>0)){if(p/=u,u<0){if(p<o)return;p<l&&(l=p)}else if(u>0){if(p>l)return;p>o&&(o=p)}if(p=r-c,!(!u&&p<0)){if(p/=u,u<0){if(p>l)return;p>o&&(o=p)}else if(u>0){if(p<o)return;p<l&&(l=p)}if(p=e-s,!(!v&&p>0)){if(p/=v,v<0){if(p<o)return;p<l&&(l=p)}else if(v>0){if(p>l)return;p>o&&(o=p)}if(p=f-s,!(!v&&p<0)){if(p/=v,v<0){if(p>l)return;p>o&&(o=p)}else if(v>0){if(p<o)return;p<l&&(l=p)}return o>0&&(n[0]=c+o*u,n[1]=s+o*v),l<1&&(t[0]=c+l*u,t[1]=s+l*v),!0}}}}}var on=1e9,gn=-on;function kt(n,t,i,e){function r(h,o){return n<=h&&h<=i&&t<=o&&o<=e}function f(h,o,l,u){var v=0,p=0;if(h==null||(v=c(h,l))!==(p=c(o,l))||g(h,o)<0^l>0)do u.point(v===0||v===3?n:i,v>1?e:t);while((v=(v+l+4)%4)!==p);else u.point(o[0],o[1])}function c(h,o){return G(h[0]-n)<W?o>0?0:3:G(h[0]-i)<W?o>0?2:1:G(h[1]-t)<W?o>0?1:0:o>0?3:2}function s(h,o){return g(h.x,o.x)}function g(h,o){var l=c(h,1),u=c(o,1);return l!==u?l-u:l===0?o[1]-h[1]:l===1?h[0]-o[0]:l===2?h[1]-o[1]:o[0]-h[0]}return function(h){var o=h,l=it(),u,v,p,y,d,x,S,M,w,L,P,F={point:C,lineStart:j,lineEnd:_,polygonStart:I,polygonEnd:E};function C(a,z){r(a,z)&&o.point(a,z)}function D(){for(var a=0,z=0,A=v.length;z<A;++z)for(var B=v[z],m=1,R=B.length,T=B[0],N,q,Q=T[0],J=T[1];m<R;++m)N=Q,q=J,T=B[m],Q=T[0],J=T[1],q<=e?J>e&&(Q-N)*(e-q)>(J-q)*(n-N)&&++a:J<=e&&(Q-N)*(e-q)<(J-q)*(n-N)&&--a;return a}function I(){o=l,u=[],v=[],P=!0}function E(){var a=D(),z=P&&a,A=(u=nt(u)).length;(z||A)&&(h.polygonStart(),z&&(h.lineStart(),f(null,null,1,h),h.lineEnd()),A&&rt(u,s,a,f,h),h.polygonEnd()),o=h,u=v=p=null}function j(){F.point=O,v&&v.push(p=[]),L=!0,w=!1,S=M=NaN}function _(){u&&(O(y,d),x&&w&&l.rejoin(),u.push(l.result())),F.point=C,w&&o.lineEnd()}function O(a,z){var A=r(a,z);if(v&&p.push([a,z]),L)y=a,d=z,x=A,L=!1,A&&(o.lineStart(),o.point(a,z));else if(A&&w)o.point(a,z);else{var B=[S=Math.max(gn,Math.min(on,S)),M=Math.max(gn,Math.min(on,M))],m=[a=Math.max(gn,Math.min(on,a)),z=Math.max(gn,Math.min(on,z))];Zt(B,m,n,t,i,e)?(w||(o.lineStart(),o.point(B[0],B[1])),o.point(m[0],m[1]),A||o.lineEnd(),P=!1):A&&(o.lineStart(),o.point(a,z),P=!1)}S=a,M=z,w=A}return F}}const $n=n=>n;var nn=1/0,En=nn,fn=-nn,mn=fn,Kn={point:bt,lineStart:rn,lineEnd:rn,polygonStart:rn,polygonEnd:rn,result:function(){var n=[[nn,En],[fn,mn]];return fn=mn=-(En=nn=1/0),n}};function bt(n,t){n<nn&&(nn=n),n>fn&&(fn=n),t<En&&(En=t),t>mn&&(mn=t)}function Nn(n){return function(t){var i=new Dn;for(var e in n)i[e]=n[e];return i.stream=t,i}}function Dn(){}Dn.prototype={constructor:Dn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function In(n,t,i){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Gt(i,n.stream(Kn)),t(Kn.result()),e!=null&&n.clipExtent(e),n}function lt(n,t,i){return In(n,function(e){var r=t[1][0]-t[0][0],f=t[1][1]-t[0][1],c=Math.min(r/(e[1][0]-e[0][0]),f/(e[1][1]-e[0][1])),s=+t[0][0]+(r-c*(e[1][0]+e[0][0]))/2,g=+t[0][1]+(f-c*(e[1][1]+e[0][1]))/2;n.scale(150*c).translate([s,g])},i)}function ne(n,t,i){return lt(n,[[0,0],t],i)}function te(n,t,i){return In(n,function(e){var r=+t,f=r/(e[1][0]-e[0][0]),c=(r-f*(e[1][0]+e[0][0]))/2,s=-f*e[0][1];n.scale(150*f).translate([c,s])},i)}function ee(n,t,i){return In(n,function(e){var r=+t,f=r/(e[1][1]-e[0][1]),c=-f*e[0][0],s=(r-f*(e[1][1]+e[0][1]))/2;n.scale(150*f).translate([c,s])},i)}var Zn=16,ie=U(30*Y);function kn(n,t){return+t?oe(n,t):re(n)}function re(n){return Nn({point:function(t,i){t=n(t,i),this.stream.point(t[0],t[1])}})}function oe(n,t){function i(e,r,f,c,s,g,h,o,l,u,v,p,y,d){var x=h-e,S=o-r,M=x*x+S*S;if(M>4*t&&y--){var w=c+u,L=s+v,P=g+p,F=yn(w*w+L*L+P*P),C=un(P/=F),D=G(G(P)-1)<W||G(f-l)<W?(f+l)/2:ln(L,w),I=n(D,C),E=I[0],j=I[1],_=E-e,O=j-r,a=S*_-x*O;(a*a/M>t||G((x*_+S*O)/M-.5)>.3||c*u+s*v+g*p<ie)&&(i(e,r,f,c,s,g,E,j,D,w/=F,L/=F,P,y,d),d.point(E,j),i(E,j,D,w,L,P,h,o,l,u,v,p,y,d))}}return function(e){var r,f,c,s,g,h,o,l,u,v,p,y,d={point:x,lineStart:S,lineEnd:w,polygonStart:function(){e.polygonStart(),d.lineStart=L},polygonEnd:function(){e.polygonEnd(),d.lineStart=S}};function x(C,D){C=n(C,D),e.point(C[0],C[1])}function S(){l=NaN,d.point=M,e.lineStart()}function M(C,D){var I=b([C,D]),E=n(C,D);i(l,u,o,v,p,y,l=E[0],u=E[1],o=C,v=I[0],p=I[1],y=I[2],Zn,e),e.point(l,u)}function w(){d.point=x,e.lineEnd()}function L(){S(),d.point=P,d.lineEnd=F}function P(C,D){M(r=C,D),f=l,c=u,s=v,g=p,h=y,d.point=M}function F(){i(l,u,o,v,p,y,f,c,r,s,g,h,Zn,e),d.lineEnd=w,w()}return d}}var le=Nn({point:function(n,t){this.stream.point(n*Y,t*Y)}});function ue(n){return Nn({point:function(t,i){var e=n(t,i);return this.stream.point(e[0],e[1])}})}function fe(n,t,i,e,r){function f(c,s){return c*=e,s*=r,[t+n*c,i-n*s]}return f.invert=function(c,s){return[(c-t)/n*e,(i-s)/n*r]},f}function bn(n,t,i,e,r,f){if(!f)return fe(n,t,i,e,r);var c=U(f),s=X(f),g=c*n,h=s*n,o=c/n,l=s/n,u=(s*i-c*t)/n,v=(s*t+c*i)/n;function p(y,d){return y*=e,d*=r,[g*y-h*d+t,i-h*y-g*d]}return p.invert=function(y,d){return[e*(o*y-l*d+u),r*(v-l*y-o*d)]},p}function ae(n){return ce(function(){return n})()}function ce(n){var t,i=150,e=480,r=250,f=0,c=0,s=0,g=0,h=0,o,l=0,u=1,v=1,p=null,y=Vn,d=null,x,S,M,w=$n,L=.5,P,F,C,D,I;function E(a){return C(a[0]*Y,a[1]*Y)}function j(a){return a=C.invert(a[0],a[1]),a&&[a[0]*K,a[1]*K]}E.stream=function(a){return D&&I===a?D:D=le(ue(o)(y(P(w(I=a)))))},E.preclip=function(a){return arguments.length?(y=a,p=void 0,O()):y},E.postclip=function(a){return arguments.length?(w=a,d=x=S=M=null,O()):w},E.clipAngle=function(a){return arguments.length?(y=+a?Kt(p=a*Y):(p=null,Vn),O()):p*K},E.clipExtent=function(a){return arguments.length?(w=a==null?(d=x=S=M=null,$n):kt(d=+a[0][0],x=+a[0][1],S=+a[1][0],M=+a[1][1]),O()):d==null?null:[[d,x],[S,M]]},E.scale=function(a){return arguments.length?(i=+a,_()):i},E.translate=function(a){return arguments.length?(e=+a[0],r=+a[1],_()):[e,r]},E.center=function(a){return arguments.length?(f=a[0]%360*Y,c=a[1]%360*Y,_()):[f*K,c*K]},E.rotate=function(a){return arguments.length?(s=a[0]%360*Y,g=a[1]%360*Y,h=a.length>2?a[2]%360*Y:0,_()):[s*K,g*K,h*K]},E.angle=function(a){return arguments.length?(l=a%360*Y,_()):l*K},E.reflectX=function(a){return arguments.length?(u=a?-1:1,_()):u<0},E.reflectY=function(a){return arguments.length?(v=a?-1:1,_()):v<0},E.precision=function(a){return arguments.length?(P=kn(F,L=a*a),O()):yn(L)},E.fitExtent=function(a,z){return lt(E,a,z)},E.fitSize=function(a,z){return ne(E,a,z)},E.fitWidth=function(a,z){return te(E,a,z)},E.fitHeight=function(a,z){return ee(E,a,z)};function _(){var a=bn(i,0,0,u,v,l).apply(null,t(f,c)),z=bn(i,e-a[0],r-a[1],u,v,l);return o=et(s,g,h),F=xn(t,z),C=xn(o,F),P=kn(F,L),O()}function O(){return D=I=null,E}return function(){return t=n.apply(this,arguments),E.invert=t.invert&&j,_()}}function Bn(n,t){return[n,Ft(_t((V+t)/2))]}Bn.invert=function(n,t){return[n,2*tt(Ot(t))-V]};function se(){return pe(Bn).scale(961/Z)}function pe(n){var t=ae(n),i=t.center,e=t.scale,r=t.translate,f=t.clipExtent,c=null,s,g,h;t.scale=function(l){return arguments.length?(e(l),o()):e()},t.translate=function(l){return arguments.length?(r(l),o()):r()},t.center=function(l){return arguments.length?(i(l),o()):i()},t.clipExtent=function(l){return arguments.length?(l==null?c=s=g=h=null:(c=+l[0][0],s=+l[0][1],g=+l[1][0],h=+l[1][1]),o()):c==null?null:[[c,s],[g,h]]};function o(){var l=H*e(),u=t(Ut(t.rotate()).invert([0,0]));return f(c==null?[[u[0]-l,u[1]-l],[u[0]+l,u[1]+l]]:n===Bn?[[Math.max(u[0]-l,c),s],[Math.min(u[0]+l,g),h]]:[[c,Math.max(u[1]-l,s)],[g,Math.min(u[1]+l,h)]])}return o()}const Se={__name:"Map",setup(n){let t=xt(),i=new ct,e=new st(90,window.innerWidth/window.innerHeight,.1,1e5);e.position.set(0,0,100),e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),i.add(e);let r=new pt(5);i.add(r);let f=new ht(16777215,1);i.add(f);const c=new vt(16777215,.5);i.add(c);let s=new gt({antialias:!0});s.setSize(window.innerWidth,window.innerHeight);let g=new Hn,h=se().center([116.402,39.915]).translate([0,0,0]),o=new dt,l=new URL("/assets/map-BqTUXMPq.json",import.meta.url).href;o.load(l,A=>{let B=JSON.parse(A);v(B)});let u=[],v=A=>{A.features.forEach(m=>{let R=new Hn;R.name=m.properties.name;let T=m.properties.centroid||m.properties.center,N=d(T,m.properties.name);T&&u.push(T),N&&R.add(N);let q=m.geometry.coordinates,Q="#99ff99";m.geometry.type==="MultiPolygon"&&q.forEach(J=>{J.forEach($=>{let k=p($,Q,h),an=y($,Q,h);an.properties=m.properties.name,R.add(k),R.add(an)})}),m.geometry.type==="Polygon"&&q.forEach(J=>{let $=p(J,Q,h),k=y(J,Q,h);k.properties=m.properties.name,R.add($),R.add(k)}),g.add(R)}),i.add(g),w(u)},p=(A,B,m)=>{let R=new Tn,T=new Array;A.forEach(Q=>{let[J,$]=m(Q);T.push(new en(J,-$,3))}),R.setFromPoints(T);let N=new wt(Math.random()*.5+.5,Math.random()*.5+.5,Math.random()*.5+.5),q=new On({color:N});return new Fn(R,q)},y=(A,B,m)=>{let R=new St;A.forEach((Q,J)=>{let[$,k]=m(Q);J===0&&R.moveTo($,-k),R.lineTo($,-k)});let T=new Et(R,{depth:3,bevelEnabled:!1}),N=(Math.random()*.5+.5)*255,q=new mt({color:N,transparent:!0,opacity:.5});return new yt(T,q)},d=(A,B)=>{if(A){let[m,R]=h(A),T=new en(m*1,-R*1,3),N=document.createElement("div");N.style.color="#ffffff",N.style.fontSize="12px",N.style.textShadow="1px 1px 2px #047cd6",N.className="map-label",N.innerHTML=B;let q=new At(N);return q.scale.set(.01,.01,.01),q.position.copy(T),q}},x=[],S=8,M=10,w=A=>{let B=A.length,m=A,R=m[0];m.shift();let T=[];for(;T.length<S*2;){let N=Math.floor(Math.random()*B);m[N]&&(T.push(m[N]),T.push(R),m.splice(N,1))}for(let N=0;N<T.length;N+=2){let[q,Q]=h([T[N][0],T[N][1]]),J=new en(q,-Q,5),[$,k]=h([T[N+1][0],T[N+1][1]]),an=new en($,-k,5),ut=new en((q+$)/2,(-Q+-$)/2,15),Mn=new Mt(J,ut,an).getPoints(M),cn=new Tn().setFromPoints(Mn);cn.vertices=Mn;let sn=[];for(let tn=0;tn<Mn.length*3;tn+=3)sn[tn]=0,sn[tn+1]=1,sn[tn+2]=0;let ft=new Wn(sn,3);cn.setAttribute("color",ft),x.push(cn);let at=new Fn(cn,new On({vertexColors:!0,transparent:!0,side:Pt,opacity:.8,linewidth:30}));i.add(at)}return x},L=0,P=0,F=()=>{let A=new Date().getTime();A-L>100&&(x.forEach((B,m)=>{if(B){let R=[];for(let N=0;N<M+1;N++)N==P?(R.push(1),R.push(1),R.push(1)):(R.push(0),R.push(1),R.push(0));let T=new Wn(R,3);B.setAttribute("color",T),B.colorsNeedUpdate=!0,P++,P>S&&(P=0)}}),L=A)},C=new Ct;C.setSize(window.innerWidth,window.innerHeight),C.domElement.style.position="absolute",C.domElement.style.left="0px",C.domElement.style.top="0px";let D,I=null,E=null,j=A=>{let B=_(A),m=new Rt;m.setFromCamera(B,e);let R=m.intersectObjects([g],!0);R.length>0?(I&&I.object.properties!==R[0].object.properties&&(I.object.material.color.set(E),I=null),R[0].object.properties&&(E=R[0].object.material.color.clone(),R[0].object.material.color.set("red")),I=R[0]):I&&I.object.properties&&(I.object.material.color.set(E),I=null)};window.addEventListener("click",j);let _=A=>{let B={x:0,y:0},m=D.getBoundingClientRect(),R={x:(A.clientX-m.left)*m.width/m.width,y:(A.clientY-m.top)*m.height/m.height};return B.x=R.x/D.width*2-1,B.y=-(R.y/D.height)*2+1,B},O=new Lt(e,C.domElement);O.enableDamping=!0;let a=()=>{O.update(),requestAnimationFrame(a),s.render(i,e),C.render(i,e),F()};a();let z=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),C.setSize(window.innerWidth,window.innerHeight),s.setSize(window.innerWidth,window.innerHeight),s.setPixelRatio(window.devicePixelRatio)};return window.addEventListener("resize",z),zt(()=>{t.value.appendChild(s.domElement),t.value.appendChild(C.domElement),D=s.domElement}),Dt(()=>{window.removeEventListener("resize",z),window.removeEventListener("click",j)}),(A,B)=>(It(),Nt("div",{id:"map",class:"mapScene",ref_key:"mapScene",ref:t},null,512))}};export{Se as default};
